--- 
title: "Rにる作業の効率化・自動化 -パッケージ活用術-"
author: "Toshikazu Masumura"
date: "2023-05-26"
site: bookdown::bookdown_site

  # https://qiita.com/Atsushi776/items/9ef1e5d744e2b91c61ee#xelatex%E3%82%92%E7%94%A8%E3%81%84%E3%82%8B%E5%A0%B4%E5%90%88
output:
  pdf_document: 
    latex_engine: xelatex 
header-includes: 
  - \usepackage{bookmark} 
  - \usepackage{xltxtra} 
  - \usepackage{zxjatype} 
  - \usepackage[ipa]{zxjafont} 
---



# はじめに {-}

<!--
TODO
コンソール出力で"matu"，"matutosi"などのユーザ情報があるところは，"username"に置換しておく
-->

誰でもそうだろうが，面倒くさい仕事はしたくない．
というか，したくないことが面倒くさいのだろう．
ニワトリとタマゴの議論は別として，できることなら面倒な作業はしたくない．
でも，しなければならないのなら自動化したい．
もちろんすべての仕事を自動化できるわけでもないし，作業内容によっては文章執筆のように自動化すべきでないこともある．

作業の自動化には，プログラミング言語を使うことが多い．
自動化でよく使われる言語にPythonがある．
Pythonは比較的習得しやすい言語らしく，多くの人が使っている．
自分自身も多少はPythonを使えるものの，それよりもRの方が慣れている．
できることなら(ほぼ)全ての作業をRでやってしまいたい．
そんなわけで，この文章ではRを使った作業の自動化や効率化手法を紹介する．

基本的に独学でここまで来たので，我流や汚いコードが多くあると思われるがご容赦頂きたい．
また，改善案をご教示いただければありがたい．

matutosi@gmail.com


## 対象とする読者

この文書は，以下の人を読者として想定している．

1 Rを使って操作を自動化したい   
2 プログラミングの基礎知識を持っている   
3 エラーが出た時に自分でネットで調べて解決できる   
4 自己責任でコードを実行できる   


1つ目は言うまでもないが，Rを使って自動化をしたい人を対象としている．
Pythonに慣れている人は，Pythonを使ったほうが早いかもしれない．
あまり無いかもしれないが，Pythonでは実行できずRだけで実行できるものがあるかもしれない．
その場合は，その部分だけR本体で実行するとか，rpy2ライブラリを使えば良いかもしれない．


2つ目のRの基礎知識があれば良いが，既に仕事や研究などでRを使っていれば問題ないだろう．
この文書の多くのコードをほぼそのまま利用できるはずだ．
Rを使ったことはなくても，他のプログラミング言語を使っていれば大丈夫である．
Rやパッケージのインストールについての説明をもとにRを導入して，magrittrやstringrなどの部分を読めばある程度の理解ができるだろう．
ただし，十分ではないと思われるので，しっかり勉強しようという人は，別の書籍を1冊読むことをおすすめする．

- Rではじめるデータサイエンス   
- 改訂2版 RユーザのためのRStudio[実践]入門   
- RStudioではじめるRプログラミング入門   


3つ目のエラーについてだが，OSの違いやその他の環境の違いによって，この文書のコードを実行したときにエラーが発生する可能性がある．
その場合，自分のまわりにR上級者がいれば，質問できるだろう．
しかし，そうでないときには，自分でネットで検索して解決しなければならない．
そのときには，実行したコードとエラーの内容をもとに検索して解決して欲しい．
できれば，日本語よりも英語で検索するのが良い．
圧倒的に情報量が違うからだ．

エラーが発生して，検索しても解決しなければ質問を送って頂いても，もちろん構わない．
ただし，Windows以外のOSはほとんど使ったことがないため対処できない可能性が高いことや，
Windowsであっても全てに対処できるわけではないことはご了承頂きたい．

4つ目の自己責任については，プログラムの基本中の基本である．
特に作業を自動化するということは，危険な場合がある．
この文書や改良したコードを実行して何らかのデータが消失したり，損害を与えたりする可能性がある．
そのためコードの実行には注意をするとともに，自己責任で実行してほしい．

ファイルの上書き保存や削除の際には，細心の注意が必要だろう．
ファイルの保存のときには上書きするのではなく，作業ディレクトリに一旦コピーしてから作業すると良いだろう．
削除のときは，ディレクトリ全体ではなく個別のファイル名を指定すると，「すべて消えてしまった!」という間違いを回避できる可能性が高い．

## 特徴

この文書の特徴は，以下の2つがある．

- Rを使った自動化の解説である   
- コードをほぼそのまま実行できる(GitHub)   

自動化についてR(Pythonではなく)を使った解説に焦点を当てていることである．
Pythonを使った自動化については多くの書籍やネット上にも多くの文書がある．
Python自体がプログラミング言語で最も使われているものの一つで，自動化のためのライブラリも充実しているからだ．
RはPythonと比べられることがあるものの，どちらかといえば統計解析に特化した言語として捉えられている．
実際にそうではあるが，Rにも結構多くの機能があり，自動化のためのパッケージも充実している．

Pythonは勉強したい言語や使っている言語の上位に位置する．
一方，Rは使いたくない言語としてあげられることがある．
Rは他の言語と比べるとちょっと独特なところがあるからだ．
それでも使ったことがない人は，一度使ってみてほしい．
独特なところが結構クセになる．


この文書のコードはコピペすれば，ほぼそのまま実行できる．
GitHubにもコードがあるので，使ってほしい．
読者の環境に合わせて，入力するべきとこももちろんある．
その部分は，`your_directory`などのように表記している．

ただし，自動化の方法は1つだけではない．
1つのことをするにしても，`system()`でのコマンドの実行やパッケージの関数の利用などのように複数の方法がある．
プログラムをする場合は，後で見直して自分で修正できるようにすることが重要だ．
まずは，この文書のコードをコピペして使い，分かりにくい部分は自分なりの書き方に変えてほしい．
その上でさらに改善を重ね，コードを組み合わせると独自の自動化手法ができる．

## 読み方

???章のRやパッケージのインストールについてを除いて，基本的には各章の内容は独立しているので，読者の興味に合わせて好きな部分を読めば良いだろう．
各章では，パッケージごとに基本的な関数の説明や自動化のための活用方法を紹介している．
ただし，magirittr，stringr，fsパッケージは他の章でもよく使っているので，まずはここから読むと理解が早いと思われる．
また，これら以外にも他の章で解説するパッケージを利用していることがあるので，必要に応じて関連部分を読んでほしい．
