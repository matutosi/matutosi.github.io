<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chap. 6 tidyverseを使う | Rにる作業の効率化・自動化 -パッケージ活用術-</title>
  <meta name="description" content="Chap. 6 tidyverseを使う | Rにる作業の効率化・自動化 -パッケージ活用術-" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chap. 6 tidyverseを使う | Rにる作業の効率化・自動化 -パッケージ活用術-" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chap. 6 tidyverseを使う | Rにる作業の効率化・自動化 -パッケージ活用術-" />
  
  
  

<meta name="author" content="Toshikazu Masumura" />


<meta name="date" content="2023-07-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="magrittr.html"/>
<link rel="next" href="lubridate.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>はじめに</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#対象とする読者"><i class="fa fa-check"></i><b>0.1</b> 対象とする読者</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#特徴"><i class="fa fa-check"></i><b>0.2</b> 特徴</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#読み方"><i class="fa fa-check"></i><b>0.3</b> 読み方</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="R.html"><a href="R.html"><i class="fa fa-check"></i><b>1</b> Rとは</a>
<ul>
<li class="chapter" data-level="1.1" data-path="R.html"><a href="R.html#特徴-1"><i class="fa fa-check"></i><b>1.1</b> 特徴</a></li>
<li class="chapter" data-level="1.2" data-path="R.html"><a href="R.html#点突破"><i class="fa fa-check"></i><b>1.2</b> 1点突破</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>2</b> Rのインストール</a>
<ul>
<li class="chapter" data-level="2.1" data-path="install.html"><a href="install.html#ダウンロード"><i class="fa fa-check"></i><b>2.1</b> ダウンロード</a></li>
<li class="chapter" data-level="2.2" data-path="install.html"><a href="install.html#インストーラの起動"><i class="fa fa-check"></i><b>2.2</b> インストーラの起動</a></li>
<li class="chapter" data-level="2.3" data-path="install.html"><a href="install.html#インストール完了"><i class="fa fa-check"></i><b>2.3</b> インストール完了</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="package.html"><a href="package.html"><i class="fa fa-check"></i><b>3</b> パッケージのインストール</a>
<ul>
<li class="chapter" data-level="3.1" data-path="package.html"><a href="package.html#cran"><i class="fa fa-check"></i><b>3.1</b> CRANから</a></li>
<li class="chapter" data-level="3.2" data-path="package.html"><a href="package.html#アーカイブされたパッケージ"><i class="fa fa-check"></i><b>3.2</b> アーカイブされたパッケージ</a></li>
<li class="chapter" data-level="3.3" data-path="package.html"><a href="package.html#cranからpackage一覧を取得する"><i class="fa fa-check"></i><b>3.3</b> CRANからPackage一覧を取得する</a></li>
<li class="chapter" data-level="3.4" data-path="package.html"><a href="package.html#github"><i class="fa fa-check"></i><b>3.4</b> GitHubから</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="assoc.html"><a href="assoc.html"><i class="fa fa-check"></i><b>4</b> スクリプトの関連付け</a>
<ul>
<li class="chapter" data-level="4.1" data-path="assoc.html"><a href="assoc.html#windows"><i class="fa fa-check"></i><b>4.1</b> Windows</a></li>
<li class="chapter" data-level="4.2" data-path="assoc.html"><a href="assoc.html#macとlinux"><i class="fa fa-check"></i><b>4.2</b> MacとLinux</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="magrittr.html"><a href="magrittr.html"><i class="fa fa-check"></i><b>5</b> magrittrでコードを簡潔に</a>
<ul>
<li class="chapter" data-level="5.1" data-path="magrittr.html"><a href="magrittr.html#準備"><i class="fa fa-check"></i><b>5.1</b> 準備</a></li>
<li class="chapter" data-level="5.2" data-path="magrittr.html"><a href="magrittr.html#magrittrとtidyverse"><i class="fa fa-check"></i><b>5.2</b> magrittrとtidyverse</a></li>
<li class="chapter" data-level="5.3" data-path="magrittr.html"><a href="magrittr.html#でコードを簡潔に"><i class="fa fa-check"></i><b>5.3</b> <code>%&gt;%</code>でコードを簡潔に</a></li>
<li class="chapter" data-level="5.4" data-path="magrittr.html"><a href="magrittr.html#パイプの仲間"><i class="fa fa-check"></i><b>5.4</b> パイプの仲間</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="magrittr.html"><a href="magrittr.html#でオブジェクトを代入"><i class="fa fa-check"></i><b>5.4.1</b> <code>%&lt;&gt;%</code>でオブジェクトを代入</a></li>
<li class="chapter" data-level="5.4.2" data-path="magrittr.html"><a href="magrittr.html#tでコードを分岐"><i class="fa fa-check"></i><b>5.4.2</b> <code>%T&gt;%</code>でコードを分岐</a></li>
<li class="chapter" data-level="5.4.3" data-path="magrittr.html"><a href="magrittr.html#でのショートカット"><i class="fa fa-check"></i><b>5.4.3</b> <code>%$%</code>で<code>$</code>のショートカット</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="magrittr.html"><a href="magrittr.html#パイプ以外の関数"><i class="fa fa-check"></i><b>5.5</b> パイプ以外の関数</a></li>
<li class="chapter" data-level="5.6" data-path="magrittr.html"><a href="magrittr.html#コラムmagrittrの不思議な関数たち"><i class="fa fa-check"></i><b>5.6</b> コラム：magrittrの不思議な関数たち</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>6</b> tidyverseを使う</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tidyverse.html"><a href="tidyverse.html#準備-1"><i class="fa fa-check"></i><b>6.1</b> 準備</a></li>
<li class="chapter" data-level="6.2" data-path="tidyverse.html"><a href="tidyverse.html#tidyverseとは"><i class="fa fa-check"></i><b>6.2</b> tidyverseとは</a></li>
<li class="chapter" data-level="6.3" data-path="tidyverse.html"><a href="tidyverse.html#tibbleでデータフレームを使いやすくする"><i class="fa fa-check"></i><b>6.3</b> tibbleでデータフレームを使いやすくする</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="tidyverse.html"><a href="tidyverse.html#データフレームとtibble"><i class="fa fa-check"></i><b>6.3.1</b> データフレームとtibble</a></li>
<li class="chapter" data-level="6.3.2" data-path="tidyverse.html"><a href="tidyverse.html#tibbleの気の利いた表示"><i class="fa fa-check"></i><b>6.3.2</b> tibbleの気の利いた表示</a></li>
<li class="chapter" data-level="6.3.3" data-path="tidyverse.html"><a href="tidyverse.html#tibbleへの変換tibbleの生成"><i class="fa fa-check"></i><b>6.3.3</b> tibbleへの変換，tibbleの生成</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="tidyverse.html"><a href="tidyverse.html#tidyrでデータを整形する"><i class="fa fa-check"></i><b>6.4</b> tidyrでデータを整形する</a></li>
<li class="chapter" data-level="6.5" data-path="tidyverse.html"><a href="tidyverse.html#readrでファイルの保存と読み込み"><i class="fa fa-check"></i><b>6.5</b> readrでファイルの保存と読み込み</a></li>
<li class="chapter" data-level="6.6" data-path="tidyverse.html"><a href="tidyverse.html#dplyrでデータフレームを操作する"><i class="fa fa-check"></i><b>6.6</b> dplyrでデータフレームを操作する</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="tidyverse.html"><a href="tidyverse.html#cranのパッケージを分類する"><i class="fa fa-check"></i><b>6.6.1</b> CRANのパッケージを分類する</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="tidyverse.html"><a href="tidyverse.html#stringr"><i class="fa fa-check"></i><b>6.7</b> stringrで文字列操作</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="tidyverse.html"><a href="tidyverse.html#stringrの主な関数"><i class="fa fa-check"></i><b>6.7.1</b> stringrの主な関数</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="tidyverse.html"><a href="tidyverse.html#purrr"><i class="fa fa-check"></i><b>6.8</b> purrrで繰り返し処理</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="tidyverse.html"><a href="tidyverse.html#zipファイルの解凍"><i class="fa fa-check"></i><b>6.8.1</b> zipファイルの解凍</a></li>
<li class="chapter" data-level="6.8.2" data-path="tidyverse.html"><a href="tidyverse.html#科研費の審査委員の名簿取得"><i class="fa fa-check"></i><b>6.8.2</b> 科研費の審査委員の名簿取得</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lubridate.html"><a href="lubridate.html"><i class="fa fa-check"></i><b>7</b> lubridateで日付・時刻を扱う</a>
<ul>
<li class="chapter" data-level="7.1" data-path="lubridate.html"><a href="lubridate.html#準備-2"><i class="fa fa-check"></i><b>7.1</b> 準備</a></li>
<li class="chapter" data-level="7.2" data-path="lubridate.html"><a href="lubridate.html#月後1年後の同一日"><i class="fa fa-check"></i><b>7.2</b> 1月後・1年後の同一日</a></li>
<li class="chapter" data-level="7.3" data-path="lubridate.html"><a href="lubridate.html#文字列からdateクラスへの変換"><i class="fa fa-check"></i><b>7.3</b> 文字列からDateクラスへの変換</a></li>
<li class="chapter" data-level="7.4" data-path="lubridate.html"><a href="lubridate.html#曜日を求める"><i class="fa fa-check"></i><b>7.4</b> 曜日を求める</a></li>
<li class="chapter" data-level="7.5" data-path="lubridate.html"><a href="lubridate.html#活用例"><i class="fa fa-check"></i><b>7.5</b> 活用例</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fs.html"><a href="fs.html"><i class="fa fa-check"></i><b>8</b> fsでファイル操作</a>
<ul>
<li class="chapter" data-level="8.1" data-path="fs.html"><a href="fs.html#準備-3"><i class="fa fa-check"></i><b>8.1</b> 準備</a></li>
<li class="chapter" data-level="8.2" data-path="fs.html"><a href="fs.html#シェルbaseパッケージ-fsパッケージ"><i class="fa fa-check"></i><b>8.2</b> シェル，baseパッケージ, fsパッケージ</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="fs.html"><a href="fs.html#シェルを使う"><i class="fa fa-check"></i><b>8.2.1</b> シェルを使う</a></li>
<li class="chapter" data-level="8.2.2" data-path="fs.html"><a href="fs.html#baseパッケージ"><i class="fa fa-check"></i><b>8.2.2</b> baseパッケージ</a></li>
<li class="chapter" data-level="8.2.3" data-path="fs.html"><a href="fs.html#fsパッケージ"><i class="fa fa-check"></i><b>8.2.3</b> fsパッケージ</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="fs.html"><a href="fs.html#fsの関数"><i class="fa fa-check"></i><b>8.3</b> fsの関数</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="fs.html"><a href="fs.html#パス操作"><i class="fa fa-check"></i><b>8.3.1</b> パス操作</a></li>
<li class="chapter" data-level="8.3.2" data-path="fs.html"><a href="fs.html#ディレクトリ操作"><i class="fa fa-check"></i><b>8.3.2</b> ディレクトリ操作</a></li>
<li class="chapter" data-level="8.3.3" data-path="fs.html"><a href="fs.html#ファイル操作"><i class="fa fa-check"></i><b>8.3.3</b> ファイル操作</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="fs.html"><a href="fs.html#fsを使ったファイル操作例"><i class="fa fa-check"></i><b>8.4</b> fsを使ったファイル操作例</a></li>
<li class="chapter" data-level="8.5" data-path="fs.html"><a href="fs.html#コラムguiでの作業ディレクトリの指定"><i class="fa fa-check"></i><b>8.5</b> コラム：GUIでの作業ディレクトリの指定</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="shell.html"><a href="shell.html"><i class="fa fa-check"></i><b>9</b> system()やshell()でOSコマンドの実行</a>
<ul>
<li class="chapter" data-level="9.1" data-path="shell.html"><a href="shell.html#準備-4"><i class="fa fa-check"></i><b>9.1</b> 準備</a></li>
<li class="chapter" data-level="9.2" data-path="shell.html"><a href="shell.html#install_python"><i class="fa fa-check"></i><b>9.2</b> 活用例：Pythonとそのライブラリのインストール</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="shell.html"><a href="shell.html#pythonのイントール"><i class="fa fa-check"></i><b>9.2.1</b> Pythonのイントール</a></li>
<li class="chapter" data-level="9.2.2" data-path="shell.html"><a href="shell.html#pillowとpyautoguiのインストール"><i class="fa fa-check"></i><b>9.2.2</b> PillowとPyAutoGUIのインストール</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="shell.html"><a href="shell.html#windowsでのアプリディレクトリの瞬間起動-run_in-a_second"><i class="fa fa-check"></i><b>9.3</b> Windowsでのアプリ・ディレクトリの瞬間起動 {#run_in a_second}</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="deeplr.html"><a href="deeplr.html"><i class="fa fa-check"></i><b>10</b> Deeplrで翻訳する</a>
<ul>
<li class="chapter" data-level="10.1" data-path="deeplr.html"><a href="deeplr.html#準備-5"><i class="fa fa-check"></i><b>10.1</b> 準備</a></li>
<li class="chapter" data-level="10.2" data-path="deeplr.html"><a href="deeplr.html#deeplのapi"><i class="fa fa-check"></i><b>10.2</b> DeepLのAPI</a></li>
<li class="chapter" data-level="10.3" data-path="deeplr.html"><a href="deeplr.html#deeplr-1"><i class="fa fa-check"></i><b>10.3</b> deeplr</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reticulate.html"><a href="reticulate.html"><i class="fa fa-check"></i><b>11</b> reticulateでPythonを使う</a>
<ul>
<li class="chapter" data-level="11.1" data-path="reticulate.html"><a href="reticulate.html#準備-6"><i class="fa fa-check"></i><b>11.1</b> 準備</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="reticulate.html"><a href="reticulate.html#pythonとpyautoguiのインストール"><i class="fa fa-check"></i><b>11.1.1</b> PythonとPyAutoGUIのインストール</a></li>
<li class="chapter" data-level="11.1.2" data-path="reticulate.html"><a href="reticulate.html#identify_python"><i class="fa fa-check"></i><b>11.1.2</b> 使用するPythonの指定</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="reticulate.html"><a href="reticulate.html#pythonを使ってみる"><i class="fa fa-check"></i><b>11.2</b> Pythonを使ってみる</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="reticulate.html"><a href="reticulate.html#pythonの呼び出し"><i class="fa fa-check"></i><b>11.2.1</b> Pythonの呼び出し</a></li>
<li class="chapter" data-level="11.2.2" data-path="reticulate.html"><a href="reticulate.html#rからpythonのhellow-world"><i class="fa fa-check"></i><b>11.2.2</b> RからPythonのHellow World!</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="reticulate.html"><a href="reticulate.html#pythoとrとの変数のやり取り"><i class="fa fa-check"></i><b>11.3</b> PythoとRとの変数のやり取り</a></li>
<li class="chapter" data-level="11.4" data-path="reticulate.html"><a href="reticulate.html#pythonのコードを実行"><i class="fa fa-check"></i><b>11.4</b> Pythonのコードを実行</a></li>
<li class="chapter" data-level="11.5" data-path="reticulate.html"><a href="reticulate.html#コラムrとpythoでの用語の違い"><i class="fa fa-check"></i><b>11.5</b> コラム：RとPythoでの用語の違い</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html"><i class="fa fa-check"></i><b>12</b> KeyboardSimulatorでマウス・キーボードの自動化</a>
<ul>
<li class="chapter" data-level="12.1" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#準備-7"><i class="fa fa-check"></i><b>12.1</b> 準備</a></li>
<li class="chapter" data-level="12.2" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#マウスの移動"><i class="fa fa-check"></i><b>12.2</b> マウスの移動</a></li>
<li class="chapter" data-level="12.3" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#マウスの位置取得"><i class="fa fa-check"></i><b>12.3</b> マウスの位置取得</a></li>
<li class="chapter" data-level="12.4" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#usbメモリの安全な取り出しの自動化"><i class="fa fa-check"></i><b>12.4</b> USBメモリの安全な取り出しの自動化</a></li>
<li class="chapter" data-level="12.5" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#画像をもとにマウスを動かしてクリックする"><i class="fa fa-check"></i><b>12.5</b> 画像をもとにマウスを動かしてクリックする</a></li>
<li class="chapter" data-level="12.6" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#まとめ"><i class="fa fa-check"></i><b>12.6</b> まとめ</a></li>
<li class="chapter" data-level="12.7" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#コラム画面サイズ取得の試行錯誤"><i class="fa fa-check"></i><b>12.7</b> (コラム)画面サイズ取得の試行錯誤</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>13</b> ggplot2で楽に綺麗に作図</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ggplot2.html"><a href="ggplot2.html#準備-8"><i class="fa fa-check"></i><b>13.1</b> 準備</a></li>
<li class="chapter" data-level="13.2" data-path="ggplot2.html"><a href="ggplot2.html#rの作図環境の概要"><i class="fa fa-check"></i><b>13.2</b> Rの作図環境の概要</a></li>
<li class="chapter" data-level="13.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2とは"><i class="fa fa-check"></i><b>13.3</b> ggplot2とは</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2の利点"><i class="fa fa-check"></i><b>13.3.1</b> ggplot2の利点</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2の基本"><i class="fa fa-check"></i><b>13.4</b> ggplot2の基本</a></li>
<li class="chapter" data-level="13.5" data-path="ggplot2.html"><a href="ggplot2.html#facetで簡単に分割作図"><i class="fa fa-check"></i><b>13.5</b> facetで簡単に分割作図</a></li>
<li class="chapter" data-level="13.6" data-path="ggplot2.html"><a href="ggplot2.html#ggsave"><i class="fa fa-check"></i><b>13.6</b> ggsave</a></li>
<li class="chapter" data-level="13.7" data-path="ggplot2.html"><a href="ggplot2.html#文字化けへの対処windows"><i class="fa fa-check"></i><b>13.7</b> 文字化けへの対処(windows)</a></li>
<li class="chapter" data-level="13.8" data-path="ggplot2.html"><a href="ggplot2.html#themeを少しだけ説明"><i class="fa fa-check"></i><b>13.8</b> themeを少しだけ説明</a></li>
<li class="chapter" data-level="13.9" data-path="ggplot2.html"><a href="ggplot2.html#作図の自動化"><i class="fa fa-check"></i><b>13.9</b> 作図の自動化</a></li>
<li class="chapter" data-level="13.10" data-path="ggplot2.html"><a href="ggplot2.html#参考書"><i class="fa fa-check"></i><b>13.10</b> 参考書</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rvest.html"><a href="rvest.html"><i class="fa fa-check"></i><b>14</b> rvestでスクレイピング</a>
<ul>
<li class="chapter" data-level="14.1" data-path="rvest.html"><a href="rvest.html#スクレイピング"><i class="fa fa-check"></i><b>14.1</b> スクレイピング</a></li>
<li class="chapter" data-level="14.2" data-path="rvest.html"><a href="rvest.html#rvest-と-rselenium"><i class="fa fa-check"></i><b>14.2</b> rvest と RSelenium</a></li>
<li class="chapter" data-level="14.3" data-path="rvest.html"><a href="rvest.html#rvestのできること"><i class="fa fa-check"></i><b>14.3</b> rvestのできること</a></li>
<li class="chapter" data-level="14.4" data-path="rvest.html"><a href="rvest.html#準備-9"><i class="fa fa-check"></i><b>14.4</b> 準備</a></li>
<li class="chapter" data-level="14.5" data-path="rvest.html"><a href="rvest.html#htmlの取得"><i class="fa fa-check"></i><b>14.5</b> HTMLの取得</a></li>
<li class="chapter" data-level="14.6" data-path="rvest.html"><a href="rvest.html#必要な情報の取得"><i class="fa fa-check"></i><b>14.6</b> 必要な情報の取得</a></li>
<li class="chapter" data-level="14.7" data-path="rvest.html"><a href="rvest.html#urlの生成データの取得"><i class="fa fa-check"></i><b>14.7</b> URLの生成・データの取得</a></li>
<li class="chapter" data-level="14.8" data-path="rvest.html"><a href="rvest.html#地図画像の取得"><i class="fa fa-check"></i><b>14.8</b> 地図画像の取得</a></li>
<li class="chapter" data-level="14.9" data-path="rvest.html"><a href="rvest.html#複数種への対応"><i class="fa fa-check"></i><b>14.9</b> 複数種への対応</a></li>
<li class="chapter" data-level="14.10" data-path="rvest.html"><a href="rvest.html#webshot"><i class="fa fa-check"></i><b>14.10</b> おまけ：webshotでウエブページを画像に変換</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="rselenium.html"><a href="rselenium.html"><i class="fa fa-check"></i><b>15</b> Rseleniumでスクレイピング</a>
<ul>
<li class="chapter" data-level="15.1" data-path="rselenium.html"><a href="rselenium.html#準備-10"><i class="fa fa-check"></i><b>15.1</b> 準備</a></li>
<li class="chapter" data-level="15.2" data-path="rselenium.html"><a href="rselenium.html#ブラウザの自動化"><i class="fa fa-check"></i><b>15.2</b> ブラウザの自動化</a></li>
<li class="chapter" data-level="15.3" data-path="rselenium.html"><a href="rselenium.html#section"><i class="fa fa-check"></i><b>15.3</b> </a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="rselenium.html"><a href="rselenium.html#使い方"><i class="fa fa-check"></i><b>15.3.1</b> 使い方</a></li>
<li class="chapter" data-level="15.3.2" data-path="rselenium.html"><a href="rselenium.html#注意点"><i class="fa fa-check"></i><b>15.3.2</b> 注意点</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="rselenium.html"><a href="rselenium.html#要素の取得"><i class="fa fa-check"></i><b>15.4</b> 要素の取得</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="magick.html"><a href="magick.html"><i class="fa fa-check"></i><b>16</b> magickで画像編集</a>
<ul>
<li class="chapter" data-level="16.1" data-path="magick.html"><a href="magick.html#準備-11"><i class="fa fa-check"></i><b>16.1</b> 準備</a></li>
<li class="chapter" data-level="16.2" data-path="magick.html"><a href="magick.html#使い方-1"><i class="fa fa-check"></i><b>16.2</b> 使い方</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="magick.html"><a href="magick.html#読み込み表示変換保存"><i class="fa fa-check"></i><b>16.2.1</b> 読み込み・表示・変換・保存</a></li>
<li class="chapter" data-level="16.2.2" data-path="magick.html"><a href="magick.html#切り出し"><i class="fa fa-check"></i><b>16.2.2</b> 切り出し</a></li>
<li class="chapter" data-level="16.2.3" data-path="magick.html"><a href="magick.html#サイズの変更"><i class="fa fa-check"></i><b>16.2.3</b> サイズの変更</a></li>
<li class="chapter" data-level="16.2.4" data-path="magick.html"><a href="magick.html#枠余白の追加註釈テキストの追加"><i class="fa fa-check"></i><b>16.2.4</b> 枠(余白)の追加・註釈(テキスト)の追加</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="magick.html"><a href="magick.html#その他の関数"><i class="fa fa-check"></i><b>16.3</b> その他の関数</a></li>
<li class="chapter" data-level="16.4" data-path="magick.html"><a href="magick.html#ウエブのスクリーンショットにurlを付加する関数"><i class="fa fa-check"></i><b>16.4</b> ウエブのスクリーンショットにURLを付加する関数</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="dbi.html"><a href="dbi.html"><i class="fa fa-check"></i><b>17</b> DBIでデータ取得</a>
<ul>
<li class="chapter" data-level="17.1" data-path="dbi.html"><a href="dbi.html#データベースとの連携"><i class="fa fa-check"></i><b>17.1</b> データベースとの連携</a></li>
<li class="chapter" data-level="17.2" data-path="dbi.html"><a href="dbi.html#dbiでできること"><i class="fa fa-check"></i><b>17.2</b> DBIでできること</a></li>
<li class="chapter" data-level="17.3" data-path="dbi.html"><a href="dbi.html#準備-12"><i class="fa fa-check"></i><b>17.3</b> 準備</a></li>
<li class="chapter" data-level="17.4" data-path="dbi.html"><a href="dbi.html#使い方-2"><i class="fa fa-check"></i><b>17.4</b> 使い方</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="openxlsx.html"><a href="openxlsx.html"><i class="fa fa-check"></i><b>18</b> openxlsxでエクセル操作</a>
<ul>
<li class="chapter" data-level="18.1" data-path="openxlsx.html"><a href="openxlsx.html#準備-13"><i class="fa fa-check"></i><b>18.1</b> 準備</a></li>
<li class="chapter" data-level="18.2" data-path="openxlsx.html"><a href="openxlsx.html#列幅の変更オートフィルタの設定ウィンドウ枠の固定"><i class="fa fa-check"></i><b>18.2</b> 列幅の変更，オートフィルタの設定，ウィンドウ枠の固定</a></li>
<li class="chapter" data-level="18.3" data-path="openxlsx.html"><a href="openxlsx.html#罫線の設定"><i class="fa fa-check"></i><b>18.3</b> 罫線の設定</a></li>
<li class="chapter" data-level="18.4" data-path="openxlsx.html"><a href="openxlsx.html#ヘッダーとフッターの追加"><i class="fa fa-check"></i><b>18.4</b> ヘッダーとフッターの追加</a></li>
<li class="chapter" data-level="18.5" data-path="openxlsx.html"><a href="openxlsx.html#作業の自動化"><i class="fa fa-check"></i><b>18.5</b> 作業の自動化</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="openxlsx.html"><a href="openxlsx.html#スクリプトの内容"><i class="fa fa-check"></i><b>18.5.1</b> スクリプトの内容</a></li>
<li class="chapter" data-level="18.5.2" data-path="openxlsx.html"><a href="openxlsx.html#使用方法"><i class="fa fa-check"></i><b>18.5.2</b> 使用方法</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="qpdf.html"><a href="qpdf.html"><i class="fa fa-check"></i><b>19</b> qpdfでPDF操作</a>
<ul>
<li class="chapter" data-level="19.1" data-path="qpdf.html"><a href="qpdf.html#準備-14"><i class="fa fa-check"></i><b>19.1</b> 準備</a></li>
<li class="chapter" data-level="19.2" data-path="qpdf.html"><a href="qpdf.html#qpdfでできること"><i class="fa fa-check"></i><b>19.2</b> qpdfでできること</a></li>
<li class="chapter" data-level="19.3" data-path="qpdf.html"><a href="qpdf.html#pdfの分割"><i class="fa fa-check"></i><b>19.3</b> PDFの分割</a></li>
<li class="chapter" data-level="19.4" data-path="qpdf.html"><a href="qpdf.html#pdfの結合"><i class="fa fa-check"></i><b>19.4</b> PDFの結合</a></li>
<li class="chapter" data-level="19.5" data-path="qpdf.html"><a href="qpdf.html#pdfの圧縮最適化"><i class="fa fa-check"></i><b>19.5</b> PDFの圧縮・最適化</a></li>
<li class="chapter" data-level="19.6" data-path="qpdf.html"><a href="qpdf.html#pdfへのページ番号付加"><i class="fa fa-check"></i><b>19.6</b> PDFへのページ番号付加</a></li>
<li class="chapter" data-level="19.7" data-path="qpdf.html"><a href="qpdf.html#その他の関数-1"><i class="fa fa-check"></i><b>19.7</b> その他の関数</a></li>
<li class="chapter" data-level="19.8" data-path="qpdf.html"><a href="qpdf.html#pdftools"><i class="fa fa-check"></i><b>19.8</b> pdftoolsでテキストの取り出し</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="RDCOMClient.html"><a href="RDCOMClient.html"><i class="fa fa-check"></i><b>20</b> RDCOMClientでMS WordやExcelと他形式と相互変換する</a>
<ul>
<li class="chapter" data-level="20.1" data-path="RDCOMClient.html"><a href="RDCOMClient.html#準備-15"><i class="fa fa-check"></i><b>20.1</b> 準備</a></li>
<li class="chapter" data-level="20.2" data-path="RDCOMClient.html"><a href="RDCOMClient.html#ドキュメントの形式変換"><i class="fa fa-check"></i><b>20.2</b> ドキュメントの形式変換</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="microsoft365r.html"><a href="microsoft365r.html"><i class="fa fa-check"></i><b>21</b> Microsoft365Rでメールを一斉送信する</a>
<ul>
<li class="chapter" data-level="21.1" data-path="microsoft365r.html"><a href="microsoft365r.html#outlookで複数メール送信を一斉送信"><i class="fa fa-check"></i><b>21.1</b> Outlookで複数メール送信を一斉送信</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="microsoft365r.html"><a href="microsoft365r.html#インストールと初期設定"><i class="fa fa-check"></i><b>21.1.1</b> インストールと初期設定</a></li>
<li class="chapter" data-level="21.1.2" data-path="microsoft365r.html"><a href="microsoft365r.html#とりあえず使う"><i class="fa fa-check"></i><b>21.1.2</b> とりあえず使う</a></li>
<li class="chapter" data-level="21.1.3" data-path="microsoft365r.html"><a href="microsoft365r.html#メールの一斉送信"><i class="fa fa-check"></i><b>21.1.3</b> メールの一斉送信</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="officer.html"><a href="officer.html"><i class="fa fa-check"></i><b>22</b> officerでWordやEscelの内容を編集する</a>
<ul>
<li class="chapter" data-level="22.1" data-path="officer.html"><a href="officer.html#準備-16"><i class="fa fa-check"></i><b>22.1</b> 準備</a></li>
<li class="chapter" data-level="22.2" data-path="officer.html"><a href="officer.html#officerとofficeverse"><i class="fa fa-check"></i><b>22.2</b> officerとofficeverse</a></li>
<li class="chapter" data-level="22.3" data-path="officer.html"><a href="officer.html#複数のワード文書の文字列を一括置換"><i class="fa fa-check"></i><b>22.3</b> 複数のワード文書の文字列を一括置換</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="officer.html"><a href="officer.html#置換のコードの例"><i class="fa fa-check"></i><b>22.3.1</b> 置換のコードの例</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="officer.html"><a href="officer.html#年月日の更新"><i class="fa fa-check"></i><b>22.4</b> 年月日の更新</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="officer.html"><a href="officer.html#活用例-1"><i class="fa fa-check"></i><b>22.4.1</b> 活用例</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Rにる作業の効率化・自動化 -パッケージ活用術-</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidyverse" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chap. 6</span> tidyverseを使う<a href="tidyverse.html#tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="準備-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 準備<a href="tidyverse.html#準備-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="tidyverse.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="tidyverse.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="tidyverseとは" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> tidyverseとは<a href="tidyverse.html#tidyverseとは" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>tidyverseは単一のパッケージではなく，9つのパッケージを含むパッケージ群である．</p>
<ul>
<li>tibble：データフレームの拡張型</li>
<li>tidyr：整然(tidy)データのツール</li>
<li>readr：ファイル読み込み・保存</li>
<li>dplyr：データフレーム操作</li>
<li>stringr：文字列</li>
<li>purrr：繰り返し処理</li>
<li>ggplot2：作図</li>
<li>lubridate：日付・時間データ</li>
<li>forcats：ファクター(因子)操作</li>
</ul>
<p>このうち，この文書ではファクター(因子)をほとんど扱っていないため，forcatsについては説明しない．
ggplot2とlubridateはそれぞれ第?章と第?章で説明し，その他はこの章で説明する．
<!--
以下では全体に関係するものから説明するため，上記の順序とは異なる(上記はアルファベット順)．
--></p>
</div>
<div id="tibbleでデータフレームを使いやすくする" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> tibbleでデータフレームを使いやすくする<a href="tidyverse.html#tibbleでデータフレームを使いやすくする" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="データフレームとtibble" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> データフレームとtibble<a href="tidyverse.html#データフレームとtibble" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>tidyvrseでは，データフレーム(data.frame)をさらに拡張して使いやすくした tbl_dfやtblという形式を基本的に使う．
ふつうに使っている限りはそれほど大きな違いはない．
違いないというよりも，オブジェクト名そのものや<code>print()</code>で内容を表示させたときに見やすいという利点がある．
例えば，各列のデータのタイプが表示される．
int(整数)やchr(文字列)のように省略して表示されるので，若干の慣れが必要である．</p>
</div>
<div id="tibbleの気の利いた表示" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> tibbleの気の利いた表示<a href="tidyverse.html#tibbleの気の利いた表示" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>画面の幅に表示を合わせてくれるのも良い点である．
例えば，次のように画面の幅に収まりきらない場合でも，データフレームではダラダラと表示を続ける．
一方，tibbleでは画面の幅に入る範囲に「良い感じ」にまとめて表示してくれる．
それでも表示できなかった場合は，最後に列名とその形式を出力する．</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="tidyverse.html#cb52-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb52-2"><a href="tidyverse.html#cb52-2" aria-hidden="true" tabindex="-1"></a>ncol <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb52-3"><a href="tidyverse.html#cb52-3" aria-hidden="true" tabindex="-1"></a>cnames <span class="ot">&lt;-</span> letters[<span class="fu">seq</span>(ncol)]</span>
<span id="cb52-4"><a href="tidyverse.html#cb52-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> </span>
<span id="cb52-5"><a href="tidyverse.html#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> ncol), <span class="at">ncol =</span> ncol, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">seq</span>(n), cnames)) <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="tidyverse.html#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-7"><a href="tidyverse.html#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>##            a          b          c          d         e           f         g
## 1 -2.9398334 -0.3248224 -0.1539741 -0.9757821 0.5277115  0.11375837  2.079493
## 2 -0.5402297 -2.3177966  1.4909110  0.9140251 0.4831087 -1.35040529  1.207952
## 3  1.2130966  0.2315185 -0.7716461  1.5987044 2.3693611  0.03247659 -1.383677
##            h          i          j
## 1  0.8364910  0.8118959 -0.6353845
## 2 -0.2510480 -1.4425637 -0.9539235
## 3  0.1997806  0.9032612 -1.0984996</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="tidyverse.html#cb54-1" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">as_tibble</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 10
##        a      b      c      d     e       f     g      h      i      j
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 -2.94  -0.325 -0.154 -0.976 0.528  0.114   2.08  0.836  0.812 -0.635
## 2 -0.540 -2.32   1.49   0.914 0.483 -1.35    1.21 -0.251 -1.44  -0.954
## 3  1.21   0.232 -0.772  1.60  2.37   0.0325 -1.38  0.200  0.903 -1.10</code></pre>
<p>変なたとえかもしれないが，データフレームは「言われたことをそのままやりました」という何も考えずに与えられたことをするような感じで，tibbleは「見やすく修正しておきました」という非常に気の利いた対応をする感じである．
さらに，tibbleのデフォルトでは行数が多いとき最初の10行だけ表示する．
データフレームではすべてのデータを表示させるので，巨大なデータのときに，画面がやたらスクロールして困った経験があるかもしれない．
tibbleではそれがない．
なお，行数と列数は最初に書かれている．</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="tidyverse.html#cb56-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb56-2"><a href="tidyverse.html#cb56-2" aria-hidden="true" tabindex="-1"></a>ncol <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb56-3"><a href="tidyverse.html#cb56-3" aria-hidden="true" tabindex="-1"></a>cnames <span class="ot">&lt;-</span> letters[<span class="fu">seq</span>(ncol)]</span>
<span id="cb56-4"><a href="tidyverse.html#cb56-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> </span>
<span id="cb56-5"><a href="tidyverse.html#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> ncol), <span class="at">ncol =</span> ncol, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">seq</span>(n), cnames)) <span class="sc">%&gt;%</span></span>
<span id="cb56-6"><a href="tidyverse.html#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-7"><a href="tidyverse.html#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>##              a           b           c
## 1  -1.76942413  0.91752837 -0.07807714
## 2  -0.02798643 -0.25794206 -1.92240120
## 3  -0.49140089  0.73298526  0.27226172
## 4   1.29604891  0.80730031  0.63072844
## 5   0.96443157  0.71877941  1.99254675
## 6   0.48949493 -2.03367511  1.05885509
## 7  -0.46248467 -0.11688673 -1.82095790
## 8   1.52423096  0.96656036  0.78064961
## 9   0.88503174  0.07918315  0.17227800
## 10  2.29516727 -2.08581004  0.26529252
## 11 -0.85321304  2.92952302 -0.07780186
## 12 -2.52536691  0.27828940 -0.81480118
## 13  0.24664963  0.48282502  0.62621296
## 14  0.70215423 -1.30856816  2.16722258
## 15  0.01119772  0.25084118  0.02435113
## 16 -0.46489835 -0.05534735  0.14077948
## 17  0.14039080  0.81900702 -0.11825312
## 18  0.18629789 -0.94668703  0.01215081
## 19  0.87200271  0.03120947  0.13767421
## 20 -1.64640509 -1.40476197  0.63708458
## 21  0.14524236 -0.05655211 -1.24853555</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="tidyverse.html#cb58-1" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">as_tibble</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 21 × 3
##          a       b       c
##      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 -1.77    0.918  -0.0781
##  2 -0.0280 -0.258  -1.92  
##  3 -0.491   0.733   0.272 
##  4  1.30    0.807   0.631 
##  5  0.964   0.719   1.99  
##  6  0.489  -2.03    1.06  
##  7 -0.462  -0.117  -1.82  
##  8  1.52    0.967   0.781 
##  9  0.885   0.0792  0.172 
## 10  2.30   -2.09    0.265 
## # ℹ 11 more rows</code></pre>
<p>表示したい行数を指定するには，引数<code>n</code>で指定する．
以下のコードのうち，3つ目を実行すると全行が表示されるので以下では表示を省略している．</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="tidyverse.html#cb60-1" aria-hidden="true" tabindex="-1"></a>mpg                  <span class="co"># 通常表示</span></span>
<span id="cb60-2"><a href="tidyverse.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mpg, <span class="at">n =</span> <span class="dv">30</span>)   <span class="co"># 30行を表示</span></span>
<span id="cb60-3"><a href="tidyverse.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="at">n =</span> <span class="fu">nrow</span>(mpg)) <span class="co"># 全行を表示</span></span></code></pre></div>
<p>なお，デフォルトの表示行数を変更するには，<code>options()</code>で設定する．</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="tidyverse.html#cb61-1" aria-hidden="true" tabindex="-1"></a>tibble_opt <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb61-2"><a href="tidyverse.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;tibble.print_max&quot;</span> <span class="ot">=</span> <span class="dv">10</span>, <span class="co"># 省略しない最大行数</span></span>
<span id="cb61-3"><a href="tidyverse.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;tibble.print_min&quot;</span> <span class="ot">=</span> <span class="dv">5</span>   <span class="co"># 省略時に表示する行数</span></span>
<span id="cb61-4"><a href="tidyverse.html#cb61-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-5"><a href="tidyverse.html#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(tibble_opt)</span></code></pre></div>
</div>
<div id="tibbleへの変換tibbleの生成" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> tibbleへの変換，tibbleの生成<a href="tidyverse.html#tibbleへの変換tibbleの生成" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>すでにデータフレームがある場合は，<code>as_tibble()</code>でtibbleへの変換ができる．</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="tidyverse.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="tidyverse.html#cb64-1" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">as_tibble</span>(mtcars)</span></code></pre></div>
<pre><code>## # A tibble: 32 × 11
##      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
##  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
##  3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
##  4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
##  5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
##  6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
##  7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
##  8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2
##  9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
## 10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
## # ℹ 22 more rows</code></pre>
<p>新たにtibbleを生成するには，データフレームの場合と同様である．</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="tidyverse.html#cb66-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb66-2"><a href="tidyverse.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(n), <span class="at">y =</span> <span class="fu">rnorm</span>(n))</span></code></pre></div>
<pre><code>##            x           y
## 1  0.7886027  0.10718218
## 2  0.7709998 -1.04819755
## 3  0.2278159  0.71522317
## 4  0.7423206 -1.10009790
## 5  0.7561132 -0.84884405
## 6  0.1586206 -0.01511906
## 7  0.1757450  1.42082908
## 8  0.5859514 -0.04075264
## 9  0.6378751 -0.74993129
## 10 0.2012891  0.12645643</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="tidyverse.html#cb68-1" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(n), <span class="at">y =</span> <span class="fu">rnorm</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##         x      y
##     &lt;dbl&gt;  &lt;dbl&gt;
##  1 0.496  -0.330
##  2 0.561  -2.33 
##  3 0.315   1.35 
##  4 0.0122 -2.15 
##  5 0.163   0.144
##  6 0.339   0.414
##  7 0.834   1.17 
##  8 0.0213  0.865
##  9 0.943  -1.24 
## 10 0.363   0.190</code></pre>
</div>
</div>
<div id="tidyrでデータを整形する" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> tidyrでデータを整形する<a href="tidyverse.html#tidyrでデータを整形する" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>tidyverseのtidyとは，整然としたという意味である．
データフレームやtibbleなっていればtidyかといえば，そうとは限らない．
エクセルなどのスプレッド形式にデータが保存されていてもtidyではないのと同様である．</p>
<p>tidyデータとは，次の4つを満たすもので，データベースの第3正規と同様のものである．</p>
<p>1 1つの変数が1つの列を構成する<br />
2 1つの観測が1つの行を構成する<br />
3 1つのタイプの観測群が1つの表を構成する<br />
4 1つの値が1つのセルを構成する</p>
<p>例えば，次のデータ<code>household</code>は非整然(messy，tidyの対義語)データの典型的な例である．</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="tidyverse.html#cb70-1" aria-hidden="true" tabindex="-1"></a>relig_income</span></code></pre></div>
<pre><code>## # A tibble: 18 × 11
##    religion `&lt;$10k` `$10-20k` `$20-30k` `$30-40k` `$40-50k` `$50-75k` `$75-100k`
##    &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
##  1 Agnostic      27        34        60        81        76       137        122
##  2 Atheist       12        27        37        52        35        70         73
##  3 Buddhist      27        21        30        34        33        58         62
##  4 Catholic     418       617       732       670       638      1116        949
##  5 Don’t …       15        14        15        11        10        35         21
##  6 Evangel…     575       869      1064       982       881      1486        949
##  7 Hindu          1         9         7         9        11        34         47
##  8 Histori…     228       244       236       238       197       223        131
##  9 Jehovah…      20        27        24        24        21        30         15
## 10 Jewish        19        19        25        25        30        95         69
## 11 Mainlin…     289       495       619       655       651      1107        939
## 12 Mormon        29        40        48        51        56       112         85
## 13 Muslim         6         7         9        10         9        23         16
## 14 Orthodox      13        17        23        32        32        47         38
## 15 Other C…       9         7        11        13        13        14         18
## 16 Other F…      20        33        40        46        49        63         46
## 17 Other W…       5         2         3         4         2         7          3
## 18 Unaffil…     217       299       374       365       341       528        407
## # ℹ 3 more variables: `$100-150k` &lt;dbl&gt;, `&gt;150k` &lt;dbl&gt;,
## #   `Don&#39;t know/refused` &lt;dbl&gt;</code></pre>
<p>宗教と所得についてのデータである．
1列目の宗教は問題ないが，所得という変数が1つの列ではなく2列目以降の複数の列に広がっている．
これを整理するには，<code>pivot_longer()</code>を使う．</p>
<p>1つ目の引数にはデータフレームを指定する．
ここでは<code>relig_income</code>だが，パイプが用いられているので省略されている
<code>cols</code>には整形する列を指定する．
ここでは，<code>!religion</code>で<code>religion</code>以外を指定している．
<code>names_to</code>には列名をもとに作る新たな変数(列)名を，
<code>values_to</code>にはデータの値をもとに作る新たな変数(列)名を文字列で指定する．</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="tidyverse.html#cb72-1" aria-hidden="true" tabindex="-1"></a>relig_income <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="tidyverse.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb72-3"><a href="tidyverse.html#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">!</span>religion, </span>
<span id="cb72-4"><a href="tidyverse.html#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;income&quot;</span>, </span>
<span id="cb72-5"><a href="tidyverse.html#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span></span>
<span id="cb72-6"><a href="tidyverse.html#cb72-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 180 × 3
##    religion income             count
##    &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;
##  1 Agnostic &lt;$10k                 27
##  2 Agnostic $10-20k               34
##  3 Agnostic $20-30k               60
##  4 Agnostic $30-40k               81
##  5 Agnostic $40-50k               76
##  6 Agnostic $50-75k              137
##  7 Agnostic $75-100k             122
##  8 Agnostic $100-150k            109
##  9 Agnostic &gt;150k                 84
## 10 Agnostic Don&#39;t know/refused    96
## # ℹ 170 more rows</code></pre>
<p><code>pivot_longer()</code>で出力されたデータフレームは，それぞれの変数が1列に，それぞれの観測が1行になった．
3つ目と4つ目の条件にもがっていしており，これで，tidyデータの条件を満たすことができた．
基本的にはプログラミングの際にはtidyな状態にしておくのが便利である．</p>
<p>ただし，入手データがtidyではないことはよくある．
また，関数によってはtidyではないオブジェクトを入力する必要やプログラム途中でtidyではない方が都合が良いこともある．
tidyではないものからtidyなものへの変換，あるいはその逆をするのに便利な関数がtidyrには多くある．
次のコードでパッケージ内の関数一覧が取得できる．</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="tidyverse.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(<span class="st">&quot;packages:tidyr&quot;</span>)</span></code></pre></div>
<p>以下も参考にしてほしい．</p>
<p><a href="https://tidyr.tidyverse.org/" class="uri">https://tidyr.tidyverse.org/</a></p>
<!--
`family`，`dob_child1`，`dob_child2`，`name_child1`，`name_child2`という5つの列がある．
家族番号，1人目と2人目の子どもの誕生日，1人目と2人目の子どもの名前である．

```r
household %>% 
  pivot_longer(
    cols = !family, 
    names_to = c(".value", "child"), 
    names_sep = "_", 
    values_drop_na = TRUE
  )
```

```
## # A tibble: 9 × 4
##   family child  dob        name  
##    <int> <chr>  <date>     <chr> 
## 1      1 child1 1998-11-26 Susan 
## 2      1 child2 2000-01-29 Jose  
## 3      2 child1 1996-06-22 Mark  
## 4      3 child1 2002-07-11 Sam   
## 5      3 child2 2004-04-05 Seth  
## 6      4 child1 2004-10-10 Craig 
## 7      4 child2 2009-08-27 Khai  
## 8      5 child1 2000-12-05 Parker
## 9      5 child2 2005-02-28 Gracie
```
-->
<!--
なお，手前味噌で申し訳ないが，ピボットテーブルをより簡単に作成するためのパッケージpivoteaを作成したので，興味があれば使ってみてほしい．
-->
<p><a href="https://cran.r-project.org/web/packages/pivotea/" class="uri">https://cran.r-project.org/web/packages/pivotea/</a></p>
</div>
<div id="readrでファイルの保存と読み込み" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> readrでファイルの保存と読み込み<a href="tidyverse.html#readrでファイルの保存と読み込み" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>tidyな状態に整理したデータをファイルとして保存や読み込みをするには，readrの関数を使うのが良い．
baseの<code>write.table()</code>や<code>read.table()</code>よりも使いやすく，読み込んだデータをtibble形式にしてくれるのが良い．</p>
<p>保存するときは，<code>write_csv</code>(カンマ区切り)や<code>write_tsv</code>(タブ区切り)を使う．</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="tidyverse.html#cb75-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_csv</span>(mpg, <span class="at">file =</span> <span class="st">&quot;file_path&quot;</span>)</span>
<span id="cb75-2"><a href="tidyverse.html#cb75-2" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_tsv</span>(mpg, <span class="at">file =</span> <span class="st">&quot;file_path&quot;</span>)</span></code></pre></div>
<p>読み込むときは，<code>read_csv</code>(カンマ区切り)や<code>read_tsv</code>(タブ区切り)を使う．
各列のデータ形式を指定したい場合は，<code>col_types</code>を使う．</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="tidyverse.html#cb76-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;file_path&quot;</span>)</span>
<span id="cb76-2"><a href="tidyverse.html#cb76-2" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">read_tsv</span>(<span class="st">&quot;file_path&quot;</span>)</span></code></pre></div>
<p>ここでは，第?章で保存したデータを読み込む．</p>
<!--
wd <- "D:/matu/work/ToDo/retc"
setwd(wd)
-->
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="tidyverse.html#cb77-1" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_tsv</span>(<span class="st">&quot;pkgs.txt&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb77-2"><a href="tidyverse.html#cb77-2" aria-hidden="true" tabindex="-1"></a>pkgs</span></code></pre></div>
<pre><code>## # A tibble: 19,530 × 2
##    pkg           description                                                    
##    &lt;chr&gt;         &lt;chr&gt;                                                          
##  1 A3            Accurate, Adaptable, and Accessible Error Metrics for Predicti…
##  2 AalenJohansen Conditional Aalen-Johansen Estimation                          
##  3 AATtools      Reliability and Scoring Routines for the Approach-Avoidance Ta…
##  4 ABACUS        Apps Based Activities for Communicating and Understanding Stat…
##  5 abbreviate    Readable String Abbreviation                                   
##  6 abbyyR        Access to Abbyy Optical Character Recognition (OCR) API        
##  7 abc           Tools for Approximate Bayesian Computation (ABC)               
##  8 abc.data      Data Only: Tools for Approximate Bayesian Computation (ABC)    
##  9 ABC.RAP       Array Based CpG Region Analysis Pipeline                       
## 10 ABCanalysis   Computed ABC Analysis                                          
## # ℹ 19,520 more rows</code></pre>
<p><code>col_types</code>でタイプを指定していないと色々と表示されて面倒なので，<code>show_col_types = FALSE</code>で表示を抑制している．
他にも読み込み時のオプションがあるので，<code>?read_tsv</code>で確認してほしい．</p>
<p>なお，エクセルのファイルを読み込むパッケージには，readxlがある．</p>
</div>
<div id="dplyrでデータフレームを操作する" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> dplyrでデータフレームを操作する<a href="tidyverse.html#dplyrでデータフレームを操作する" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>dplyrはデータフレームを操作するためのパッケージである．
列の追加や選択，行の抽出や並べ替え，グループ化，集計などができる．
なお，dplyrの関数名の多くはSQLを参考にしていると思われるので，SQLを使ったことがあればコードの内容を理解しやすいだろう．</p>
<!--
まずコードの例を示してから，その後で関数の説明をする．
-->
<div id="cranのパッケージを分類する" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> CRANのパッケージを分類する<a href="tidyverse.html#cranのパッケージを分類する" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ここでは，読み込んだデータフレーム<code>pkgs</code>のCRANに登録されているパッケージを分類する．
<code>mutate()</code>を使って，<code>description</code>に特定の文字列が含まれるかを判定して，その結果を真偽値の新しい列として追加する．
まずは<code>str_detect()</code>で<code>description</code>の列に”ocr”を含むかどうかをTRUEまたはFALSEで返す．
その結果をocrという列として新たに追加する．</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="tidyverse.html#cb79-1" aria-hidden="true" tabindex="-1"></a>pkgs <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="tidyverse.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ocr =</span> stringr<span class="sc">::</span><span class="fu">str_detect</span>(description, <span class="st">&quot;ocr&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 19,530 × 3
##    pkg           description                                               ocr  
##    &lt;chr&gt;         &lt;chr&gt;                                                     &lt;lgl&gt;
##  1 A3            Accurate, Adaptable, and Accessible Error Metrics for Pr… FALSE
##  2 AalenJohansen Conditional Aalen-Johansen Estimation                     FALSE
##  3 AATtools      Reliability and Scoring Routines for the Approach-Avoida… FALSE
##  4 ABACUS        Apps Based Activities for Communicating and Understandin… FALSE
##  5 abbreviate    Readable String Abbreviation                              FALSE
##  6 abbyyR        Access to Abbyy Optical Character Recognition (OCR) API   FALSE
##  7 abc           Tools for Approximate Bayesian Computation (ABC)          FALSE
##  8 abc.data      Data Only: Tools for Approximate Bayesian Computation (A… FALSE
##  9 ABC.RAP       Array Based CpG Region Analysis Pipeline                  FALSE
## 10 ABCanalysis   Computed ABC Analysis                                     FALSE
## # ℹ 19,520 more rows</code></pre>
<p><code>mutate()</code>での新しい列名は，「“」を使わずに指定する．
対話的に使っているときには，このように列名を直接入力するのが楽である．
なお，「”」を使わずに列名を変数名のように指定(評価)する方法をNSE(Non Standard Evaluation，非標準評価)という．
ただし，プログラミングの途中で使っているときには列名が一義的に決まらず，入力したデータの列名を使いたいことがある．
そのような時には，all_of(“colnames”)のように文字列として列名を指定したほうが良いことがある．</p>
<p>また，<code>mutate()</code>に似た関数として<code>transmute()</code>がある．
<code>transmute()</code>は，関数内で指定した列以外は削除する点が<code>mutate()</code>とは異なる．</p>
<p>上のコードでは，1つの文字列に対して列を追加した．
ここでは複数の文字列に対して同じことをするために，関数を作成する．
<code>mutate()</code>の内部がややトリッキーな事になっているが，実行内容は上と同じである．
意味としては，<code>str_detect()</code>で出力した真偽値を<code>kwd</code>の文字列の中身を列名として新たな列を追加している．
関数内では，新しい列名をNSEではなく，文字列として標準評価として用いるために，列名の文字列を<code>{{}}</code>で囲っている．
同様の理由で<code>=</code>ではなく<code>:=</code>というrlangパッケージの関数を使っている．
また，<code>str_detect()</code>内で<code>.data[[col]]</code>としている．
これは，文字列で列を選択するときに使用する手法である．</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="tidyverse.html#cb81-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># キーワードを列名として追加する関数，合致するときはTRUE</span></span>
<span id="cb81-2"><a href="tidyverse.html#cb81-2" aria-hidden="true" tabindex="-1"></a>add_kwd <span class="ot">&lt;-</span> <span class="cf">function</span>(df, col, kwd){</span>
<span id="cb81-3"><a href="tidyverse.html#cb81-3" aria-hidden="true" tabindex="-1"></a>  pattern <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">regex</span>(kwd, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-4"><a href="tidyverse.html#cb81-4" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb81-5"><a href="tidyverse.html#cb81-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">:=</span><span class="st">`</span>({{kwd}}, stringr<span class="sc">::</span><span class="fu">str_detect</span>(.data[[col]], pattern)))</span>
<span id="cb81-6"><a href="tidyverse.html#cb81-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-7"><a href="tidyverse.html#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># キーワードの一覧</span></span>
<span id="cb81-8"><a href="tidyverse.html#cb81-8" aria-hidden="true" tabindex="-1"></a>kwds <span class="ot">&lt;-</span> </span>
<span id="cb81-9"><a href="tidyverse.html#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;database&quot;</span>, <span class="st">&quot;excel&quot;</span>, <span class="st">&quot;file&quot;</span>, <span class="st">&quot;ggplot&quot;</span>, <span class="st">&quot;image|magick&quot;</span>, <span class="st">&quot;keyboards|mouse&quot;</span>, </span>
<span id="cb81-10"><a href="tidyverse.html#cb81-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ocr&quot;</span>, <span class="st">&quot;office&quot;</span>, <span class="st">&quot;pdf&quot;</span>, <span class="st">&quot;python&quot;</span>, <span class="st">&quot;scrape|scraping|selenium&quot;</span>, <span class="st">&quot;shell&quot;</span>)</span>
<span id="cb81-11"><a href="tidyverse.html#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># キーワード列の追加</span></span>
<span id="cb81-12"><a href="tidyverse.html#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(kwds)){</span>
<span id="cb81-13"><a href="tidyverse.html#cb81-13" aria-hidden="true" tabindex="-1"></a>  pkgs <span class="ot">&lt;-</span> <span class="fu">add_kwd</span>(pkgs, <span class="st">&quot;description&quot;</span>, kwds[i])</span>
<span id="cb81-14"><a href="tidyverse.html#cb81-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-15"><a href="tidyverse.html#cb81-15" aria-hidden="true" tabindex="-1"></a>pkgs</span></code></pre></div>
<pre><code>## # A tibble: 19,530 × 14
##    pkg           description          database excel file  ggplot `image|magick`
##    &lt;chr&gt;         &lt;chr&gt;                &lt;lgl&gt;    &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt;  &lt;lgl&gt;         
##  1 A3            Accurate, Adaptable… FALSE    FALSE FALSE FALSE  FALSE         
##  2 AalenJohansen Conditional Aalen-J… FALSE    FALSE FALSE FALSE  FALSE         
##  3 AATtools      Reliability and Sco… FALSE    FALSE FALSE FALSE  FALSE         
##  4 ABACUS        Apps Based Activiti… FALSE    FALSE FALSE FALSE  FALSE         
##  5 abbreviate    Readable String Abb… FALSE    FALSE FALSE FALSE  FALSE         
##  6 abbyyR        Access to Abbyy Opt… FALSE    FALSE FALSE FALSE  FALSE         
##  7 abc           Tools for Approxima… FALSE    FALSE FALSE FALSE  FALSE         
##  8 abc.data      Data Only: Tools fo… FALSE    FALSE FALSE FALSE  FALSE         
##  9 ABC.RAP       Array Based CpG Reg… FALSE    FALSE FALSE FALSE  FALSE         
## 10 ABCanalysis   Computed ABC Analys… FALSE    FALSE FALSE FALSE  FALSE         
## # ℹ 19,520 more rows
## # ℹ 7 more variables: `keyboards|mouse` &lt;lgl&gt;, ocr &lt;lgl&gt;, office &lt;lgl&gt;,
## #   pdf &lt;lgl&gt;, python &lt;lgl&gt;, `scrape|scraping|selenium` &lt;lgl&gt;, shell &lt;lgl&gt;</code></pre>
<p>列がたくさんできたので，そのうちのいくつかを選択および抽出してみよう．</p>
<p>データフレームの特定の列を選択するには，<code>select()</code>を使う．
<code>select()</code>でもNSEが使えるので，列名をそのまま入力する．
特定の列を除きたいときは，<code>-</code>あるいは<code>!</code>を使う．
なお，文字列で列を指定するには，<code>all_of()</code>と<code>any_of()</code>を使うことができる．
さらに，<code>starts_with()</code>や<code>ends_with()</code>，<code>contains()</code>などもある．</p>
<p><code>filter()</code>は，データフレームから条件に合致した行を抽出する．
最も単純な抽出方法は<code>ocr == TRUE</code>のように真偽値(logical，TRUE か FALSE)として判定されるものであれば，どのようなものでも構わない．
次のコードの場合は，そもそも<code>ocr</code>が真偽値なので，<code>ocr == TRUE</code>とせずに<code>ocr</code>としても同じ結果を得られる．</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="tidyverse.html#cb83-1" aria-hidden="true" tabindex="-1"></a>pkgs <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="tidyverse.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pkg, description, ocr) <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="tidyverse.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(ocr <span class="sc">==</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    pkg                description                                          ocr  
##    &lt;chr&gt;              &lt;chr&gt;                                                &lt;lgl&gt;
##  1 abbyyR             &quot;Access to Abbyy Optical Character Recognition (OCR… TRUE 
##  2 coalitions         &quot;Bayesian \&quot;\&quot;Now-Cast\&quot;\&quot; Estimation of Event Prob… TRUE 
##  3 elastes            &quot;Elastic Full Procrustes Means for Sparse and Irreg… TRUE 
##  4 googleCloudVisionR &quot;Access to the &#39;Google Cloud Vision&#39; API for Image … TRUE 
##  5 paco               &quot;Procrustes Application to Cophylogenetic Analysis&quot;  TRUE 
##  6 pcv                &quot;Procrustes Cross-Validation&quot;                        TRUE 
##  7 ProcMod            &quot;Informative Procrustean Matrix Correlation&quot;         TRUE 
##  8 RSocrata           &quot;Download or Upload &#39;Socrata&#39; Data Sets&quot;             TRUE 
##  9 soql               &quot;Helps Make Socrata Open Data API Calls&quot;             TRUE 
## 10 tesseract          &quot;Open Source OCR Engine&quot;                             TRUE</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="tidyverse.html#cb85-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(pkgs, <span class="sc">-</span>description) <span class="co"># dplyr::select(pkgs, !description)も同じ</span></span></code></pre></div>
<pre><code>## # A tibble: 19,530 × 13
##    pkg        database excel file  ggplot `image|magick` `keyboards|mouse` ocr  
##    &lt;chr&gt;      &lt;lgl&gt;    &lt;lgl&gt; &lt;lgl&gt; &lt;lgl&gt;  &lt;lgl&gt;          &lt;lgl&gt;             &lt;lgl&gt;
##  1 A3         FALSE    FALSE FALSE FALSE  FALSE          FALSE             FALSE
##  2 AalenJoha… FALSE    FALSE FALSE FALSE  FALSE          FALSE             FALSE
##  3 AATtools   FALSE    FALSE FALSE FALSE  FALSE          FALSE             FALSE
##  4 ABACUS     FALSE    FALSE FALSE FALSE  FALSE          FALSE             FALSE
##  5 abbreviate FALSE    FALSE FALSE FALSE  FALSE          FALSE             FALSE
##  6 abbyyR     FALSE    FALSE FALSE FALSE  FALSE          FALSE             TRUE 
##  7 abc        FALSE    FALSE FALSE FALSE  FALSE          FALSE             FALSE
##  8 abc.data   FALSE    FALSE FALSE FALSE  FALSE          FALSE             FALSE
##  9 ABC.RAP    FALSE    FALSE FALSE FALSE  FALSE          FALSE             FALSE
## 10 ABCanalys… FALSE    FALSE FALSE FALSE  FALSE          FALSE             FALSE
## # ℹ 19,520 more rows
## # ℹ 5 more variables: office &lt;lgl&gt;, pdf &lt;lgl&gt;, python &lt;lgl&gt;,
## #   `scrape|scraping|selenium` &lt;lgl&gt;, shell &lt;lgl&gt;</code></pre>
<p>お気づきかもしれないがpkgsはtidyではないので，ここで整形しておく．</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="tidyverse.html#cb87-1" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> </span>
<span id="cb87-2"><a href="tidyverse.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(pkgs, </span>
<span id="cb87-3"><a href="tidyverse.html#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(pkg, description), <span class="at">names_to =</span> <span class="st">&quot;kwd&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;val&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="tidyverse.html#cb87-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(val) <span class="sc">%&gt;%</span></span>
<span id="cb87-5"><a href="tidyverse.html#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 958 × 4
##    pkg              description                                      kwd   val  
##    &lt;chr&gt;            &lt;chr&gt;                                            &lt;chr&gt; &lt;lgl&gt;
##  1 abbyyR           Access to Abbyy Optical Character Recognition (… ocr   TRUE 
##  2 abjData          Databases Used Routinely by the Brazilian Jurim… data… TRUE 
##  3 ABPS             The Abnormal Blood Profile Score to Detect Bloo… file  TRUE 
##  4 ace2fastq        ACE File to FASTQ Converter                      file  TRUE 
##  5 AcousticNDLCodeR Coding Sound Files for Use with NDL              file  TRUE 
##  6 activPAL         Advanced Processing and Chart Generation from a… file  TRUE 
##  7 ADAPTS           Automated Deconvolution Augmentation of Profile… file  TRUE 
##  8 add2ggplot       Add to &#39;ggplot2&#39;                                 ggpl… TRUE 
##  9 adepro           A &#39;shiny&#39; Application for the (Audio-)Visualiza… file  TRUE 
## 10 adfExplorer      Import from and Export to Amiga Disk Files       file  TRUE 
## # ℹ 948 more rows</code></pre>
<p>tidyになったデータフレームを集計する．
<code>group_by()</code>は，指定した列のカテゴリーに従って，グループ化する．
ここでは，<code>kwd</code>の文字列でグループ化している．
<code>print()</code>で表示させると<code>Groups:   kwd [12]</code>となっており，<code>kwd</code>によって12のグループになっていることがわかる．
なお，グループ化を解除するには，<code>ungroup()</code>を用いる．</p>
<p>その後，<code>summarise()</code>でグループごとの集計ができる．
<code>n()</code>でグループごとの行数を計算する．
なお，<code>tally()</code>は<code>summarise(n = n())</code>のショートカットである．</p>
<p><code>arrange()</code>は，指定した列のデータの順序に従って並べ替えをする．
何も指定しなければ昇順，<code>desc()</code>で列名を指定すれば降順で並べ替えができる．</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="tidyverse.html#cb89-1" aria-hidden="true" tabindex="-1"></a>pkgs <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="tidyverse.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(val) <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="tidyverse.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(kwd) <span class="sc">%&gt;%</span></span>
<span id="cb89-4"><a href="tidyverse.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="tidyverse.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="co"># tally()も同じ</span></span>
<span id="cb89-6"><a href="tidyverse.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="sc">%&gt;%</span></span>
<span id="cb89-7"><a href="tidyverse.html#cb89-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 958 × 4
## # Groups:   kwd [12]
##    pkg              description                                      kwd   val  
##    &lt;chr&gt;            &lt;chr&gt;                                            &lt;chr&gt; &lt;lgl&gt;
##  1 abbyyR           Access to Abbyy Optical Character Recognition (… ocr   TRUE 
##  2 abjData          Databases Used Routinely by the Brazilian Jurim… data… TRUE 
##  3 ABPS             The Abnormal Blood Profile Score to Detect Bloo… file  TRUE 
##  4 ace2fastq        ACE File to FASTQ Converter                      file  TRUE 
##  5 AcousticNDLCodeR Coding Sound Files for Use with NDL              file  TRUE 
##  6 activPAL         Advanced Processing and Chart Generation from a… file  TRUE 
##  7 ADAPTS           Automated Deconvolution Augmentation of Profile… file  TRUE 
##  8 add2ggplot       Add to &#39;ggplot2&#39;                                 ggpl… TRUE 
##  9 adepro           A &#39;shiny&#39; Application for the (Audio-)Visualiza… file  TRUE 
## 10 adfExplorer      Import from and Export to Amiga Disk Files       file  TRUE 
## # ℹ 948 more rows
## # A tibble: 12 × 2
##    kwd                          n
##    &lt;chr&gt;                    &lt;int&gt;
##  1 database                   155
##  2 excel                       25
##  3 file                       364
##  4 ggplot                     165
##  5 image|magick               153
##  6 keyboards|mouse              6
##  7 ocr                         10
##  8 office                      19
##  9 pdf                         24
## 10 python                      18
## 11 scrape|scraping|selenium    15
## 12 shell                        4</code></pre>
<pre><code>## # A tibble: 12 × 2
##    kwd                          n
##    &lt;chr&gt;                    &lt;int&gt;
##  1 file                       364
##  2 ggplot                     165
##  3 database                   155
##  4 image|magick               153
##  5 excel                       25
##  6 pdf                         24
##  7 office                      19
##  8 python                      18
##  9 scrape|scraping|selenium    15
## 10 ocr                         10
## 11 keyboards|mouse              6
## 12 shell                        4</code></pre>
<p>ここでは紹介しなかったが他の有用な関数として，2つのデータフレームを列の内容に合わせて結合(マージ)する<code>left_join()</code>がある．
これににた関数として，右側の引数(つまり第2引数)をもとにして結合する<code>right_join()</code>，全結合する<code>full_join()</code>，マッチしなかった行を返す<code>anti_join()</code>などがある．
詳しい使い方は，ヘルプを参照してほしい．</p>
<p>また，重複行を除去する<code>distinct()</code>もよく使う関数である．</p>
</div>
</div>
<div id="stringr" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> stringrで文字列操作<a href="tidyverse.html#stringr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>stringrはstringiパッケージのラッパーである．
stringiは文字列操作のパッケージで，文字コードの変換などを含む多様な関数を含んでいる．
通常のユーザの文字列操作なら，stringrで大丈夫なことが多い．
万が一，込み入った文字列操作が必要なときは，stringiの関数を探してみると良いだろう．</p>
<p>少なくとも自分の経験では，stringrだけで操作が完結することはほとんどない．
逆に，パッケージ開発をしていてstringr(やdplyr)を使わずに一日が終わることもあまりない．
つまり，stringrはかなり便利で必要不可欠なツールである．
もちろんbaseパッケージの同様の関数を使っても機能上は問題ないことが多い．
しかし，引数の指定方法に一貫性があると，コードを綺麗に書くことができる．
綺麗なコードは，汚いコードよりも書きやすく，見た目が良く，何よりもバグが入りにくい(入らないわけではない)．</p>
<!--
  ## stringrとbase
https://heavywatal.github.io/rstats/stringr.html
https://rstudio-pubs-static.s3.amazonaws.com/92478_6704b96865e449b4bad7acb71443c8bc.html

### baseパッケージ

### stringrパッケージ
-->
<div id="stringrの主な関数" class="section level3 hasAnchor" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> stringrの主な関数<a href="tidyverse.html#stringrの主な関数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>stringrでは主な関数は<code>str_</code>で始まるようになっている．
これらの一覧は次のとおりである．
ちなみに，<code>str_subset()</code>で正規表現に合致した要素だけを返している．</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="tidyverse.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(<span class="st">&quot;package:stringr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="tidyverse.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_subset</span>(<span class="st">&quot;^str_&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;str_c&quot;             &quot;str_conv&quot;          &quot;str_count&quot;        
##  [4] &quot;str_detect&quot;        &quot;str_dup&quot;           &quot;str_ends&quot;         
##  [7] &quot;str_equal&quot;         &quot;str_escape&quot;        &quot;str_extract&quot;      
## [10] &quot;str_extract_all&quot;   &quot;str_flatten&quot;       &quot;str_flatten_comma&quot;
## [13] &quot;str_glue&quot;          &quot;str_glue_data&quot;     &quot;str_interp&quot;       
## [16] &quot;str_length&quot;        &quot;str_like&quot;          &quot;str_locate&quot;       
## [19] &quot;str_locate_all&quot;    &quot;str_match&quot;         &quot;str_match_all&quot;    
## [22] &quot;str_order&quot;         &quot;str_pad&quot;           &quot;str_rank&quot;         
## [25] &quot;str_remove&quot;        &quot;str_remove_all&quot;    &quot;str_replace&quot;      
## [28] &quot;str_replace_all&quot;   &quot;str_replace_na&quot;    &quot;str_sort&quot;         
## [31] &quot;str_split&quot;         &quot;str_split_1&quot;       &quot;str_split_fixed&quot;  
## [34] &quot;str_split_i&quot;       &quot;str_squish&quot;        &quot;str_starts&quot;       
## [37] &quot;str_sub&quot;           &quot;str_sub_all&quot;       &quot;str_sub&lt;-&quot;        
## [40] &quot;str_subset&quot;        &quot;str_to_lower&quot;      &quot;str_to_sentence&quot;  
## [43] &quot;str_to_title&quot;      &quot;str_to_upper&quot;      &quot;str_trim&quot;         
## [46] &quot;str_trunc&quot;         &quot;str_unique&quot;        &quot;str_view&quot;         
## [49] &quot;str_view_all&quot;      &quot;str_which&quot;         &quot;str_width&quot;        
## [52] &quot;str_wrap&quot;</code></pre>
<p>また，合致した以外のものを返すには，<code>negate = TRUE</code>とする．</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="tidyverse.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(<span class="st">&quot;package:stringr&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="tidyverse.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_subset</span>(<span class="st">&quot;^str_&quot;</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;%&gt;%&quot;          &quot;boundary&quot;     &quot;coll&quot;         &quot;fixed&quot;        &quot;fruit&quot;       
##  [6] &quot;invert_match&quot; &quot;regex&quot;        &quot;sentences&quot;    &quot;word&quot;         &quot;words&quot;</code></pre>
<p>このうちfruit，words，sentencesは，それぞれ果物の名前，一般的な単語，文のサンプルデータである．</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="tidyverse.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fruit)</span></code></pre></div>
<pre><code>## [1] &quot;apple&quot;       &quot;apricot&quot;     &quot;avocado&quot;     &quot;banana&quot;      &quot;bell pepper&quot;
## [6] &quot;bilberry&quot;</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="tidyverse.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(words)</span></code></pre></div>
<pre><code>## [1] &quot;a&quot;        &quot;able&quot;     &quot;about&quot;    &quot;absolute&quot; &quot;accept&quot;   &quot;account&quot;</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="tidyverse.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sentences)</span></code></pre></div>
<pre><code>## [1] &quot;The birch canoe slid on the smooth planks.&quot; 
## [2] &quot;Glue the sheet to the dark blue background.&quot;
## [3] &quot;It&#39;s easy to tell the depth of a well.&quot;     
## [4] &quot;These days a chicken leg is a rare dish.&quot;   
## [5] &quot;Rice is often served in round bowls.&quot;       
## [6] &quot;The juice of lemons makes fine punch.&quot;</code></pre>
<p><code>fixed()</code>は正規表現を使わずに，文字列を正規表現ではなくそのままの文字列として使う関数である．
これら以外のものについて知りたい場合は，ヘルプを参照して欲しい．</p>
<p><code>str_c()</code>は文字列を結合する．</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="tidyverse.html#cb102-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="st">&quot;eat &quot;</span>, fruit[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span></code></pre></div>
<pre><code>## [1] &quot;eat apple&quot;   &quot;eat apricot&quot; &quot;eat avocado&quot;</code></pre>
<p><code>str_detect()</code>は文字列の中に特定のパターンが含まれるかを検索して，<code>TRUE</code>あるいは<code>FALSE</code>を返す．</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="tidyverse.html#cb104-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">head</span>(fruit), <span class="st">&quot;ap&quot;</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="tidyverse.html#cb106-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">head</span>(fruit), <span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<p>パターンには正規表現を使うことができる．
正規表現とは，抽象的に文字列を指定する方法である．
例えば，「“a”あるいは”c”が含まれる」文字列を正規表現を使わずに検索するには以下のように<code>|</code>で論理和を求めることになる．</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="tidyverse.html#cb108-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">head</span>(fruit), <span class="st">&quot;a&quot;</span>) <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">head</span>(fruit), <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<p>これは重複部分が非常に多いので，非効率である．
そこで正規表現を使って，「“a”あるいは”c”」を表現する．
方法はいくつかあるが，<code>[]</code>で囲むとその中の文字列のいずれかとのパターンになる．
論理和と似た表現だが，<code>|</code>で繋いでも結果としては同じになる．</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="tidyverse.html#cb110-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">head</span>(fruit), <span class="st">&quot;[ac]&quot;</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="tidyverse.html#cb112-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">head</span>(fruit), <span class="st">&quot;a|c&quot;</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<p>行頭や行末を示す<code>^</code>や<code>$</code>，任意の文字<code>.</code>，文字列の0回以上や1回以上のの繰り返しの<code>*</code>や<code>+</code>などもある．</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="tidyverse.html#cb114-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">head</span>(fruit), <span class="st">&quot;^a&quot;</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="tidyverse.html#cb116-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">head</span>(fruit), <span class="st">&quot;a$&quot;</span>)</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="tidyverse.html#cb118-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">head</span>(fruit), <span class="st">&quot;a.*a&quot;</span>)</span></code></pre></div>
<pre><code>## [1] FALSE FALSE  TRUE  TRUE FALSE FALSE</code></pre>
<p>正規表現には他にも色々とあって，使えると非常に便利である．
もちろん，<code>str_detect()</code>以外のstringrの関数でも正規表現が使える．</p>
<p><code>str_replace()</code>と<code>str_replace_all()</code>は文字列の置換を行う．
<code>str_replace()</code>は，検索で見つかった文字列の最初の1つだけ置換して，<code>str_replace_all()</code>は見つかった文字列を全て置換する．
<code>str_remove()</code>と<code>str_remove_all()</code>は，検索で見つかった文字列を削除する．</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="tidyverse.html#cb120-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_replace</span>(fruit[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="st">&quot;a&quot;</span>, <span class="st">&quot;A&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Apple&quot;   &quot;Apricot&quot; &quot;Avocado&quot; &quot;bAnana&quot;</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="tidyverse.html#cb122-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(fruit[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="st">&quot;a&quot;</span>, <span class="st">&quot;A&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Apple&quot;   &quot;Apricot&quot; &quot;AvocAdo&quot; &quot;bAnAnA&quot;</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="tidyverse.html#cb124-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_remove</span>(fruit[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;pple&quot;   &quot;pricot&quot; &quot;vocado&quot; &quot;bnana&quot;</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="tidyverse.html#cb126-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(fruit[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;pple&quot;   &quot;pricot&quot; &quot;vocdo&quot;  &quot;bnn&quot;</code></pre>
<p><code>str_pad()</code>は文字数の長さを揃えるときに役立つ．
文字列だけでなく，数字の桁揃えでも使える．</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="tidyverse.html#cb128-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_pad</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">width =</span> <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;01&quot; &quot;02&quot; &quot;03&quot; &quot;04&quot; &quot;05&quot; &quot;06&quot; &quot;07&quot; &quot;08&quot; &quot;09&quot; &quot;10&quot;</code></pre>
</div>
</div>
<div id="purrr" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> purrrで繰り返し処理<a href="tidyverse.html#purrr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>プログラミングで繰り返し処理では，forやwhileでのループが基本である．
ただし，パイプで繋いで処理していくときに，途中でforループを使うとコードが途切れてしまう．
また，実行速度としてはあまり早くない．
このような欠点を補うには，purrrの<code>map()</code>とその派生関数を使うとよい．</p>
<p><code>map()</code>は，第1引数にベクトルかリストを，第2引数に関数を指定する．
関数の引数がある場合は，第2引数のうしろにに引数を追加する．
<code>map()</code>はリストを返すが，doubleのベクトルを返したい場合は<code>map_dbl()</code>を使う．
その他，文字列を返す<code>map_chr()</code>，論理値を返す<code>map_lgl()</code>，整数を返す<code>map_int()</code>などがある．</p>
<p>以下では，100から10000個の乱数を生成し，標本誤差を求め，散布図を描画する．</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="tidyverse.html#cb130-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span> <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb130-2"><a href="tidyverse.html#cb130-2" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(rnorm) <span class="sc">%&gt;%</span></span>
<span id="cb130-3"><a href="tidyverse.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_dbl</span>(<span class="cf">function</span>(x){ <span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(x)) }) <span class="sc">%&gt;%</span></span>
<span id="cb130-4"><a href="tidyverse.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<div id="zipファイルの解凍" class="section level3 hasAnchor" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> zipファイルの解凍<a href="tidyverse.html#zipファイルの解凍" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>zipファイルの一覧を取得して，全てのzipファイルを解凍するには以下のようにする．</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="tidyverse.html#cb131-1" aria-hidden="true" tabindex="-1"></a>unzips <span class="ot">&lt;-</span> </span>
<span id="cb131-2"><a href="tidyverse.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="at">regex =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.zip&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="tidyverse.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_chr</span>(unzip)</span></code></pre></div>
<p>返り値として入力したものそのものが必要であれば，<code>walk()</code>を使う．</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="tidyverse.html#cb132-1" aria-hidden="true" tabindex="-1"></a>zips <span class="ot">&lt;-</span> </span>
<span id="cb132-2"><a href="tidyverse.html#cb132-2" aria-hidden="true" tabindex="-1"></a>  fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="at">regex =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.zip&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-3"><a href="tidyverse.html#cb132-3" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">walk</span>(unzip)</span></code></pre></div>
<p><code>map()</code>を拡張した関数として，ベクトルまたはリストの引数を2つとる<code>map2()</code>や，さらに多くの引数をしていしるために，データフレームを引数とする<code>pmap()</code>がある．</p>
</div>
<div id="科研費の審査委員の名簿取得" class="section level3 hasAnchor" number="6.8.2">
<h3><span class="header-section-number">6.8.2</span> 科研費の審査委員の名簿取得<a href="tidyverse.html#科研費の審査委員の名簿取得" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>科学研究費助成事業，いわゆる科研費の審査委員は何年後かに名簿が公開される．
ただ，基盤Aなどの種目ごとで，さらに小委員会ごとというように，かなり細かい区分でPDFファイルが作成されている．
特定の分野のみで1つか2つぐらいの審査委員を見るのなら手作業でも良いが，多くをダウンロードするなら自動化したい．</p>
<p>個人的な経験だが，科研費でどの分野で応募するか(つまり審査委員による)，採否に大きく影響する．
不採択で開示された審査結果でも「C」つまり採択されなかった中で下位50%という申請書があったが，自分ではかなり頑張って作ったつもりだった．
そこで，年度のみ変更して内容はほぼそのままで分野を変えて申請した．
すると，採択されたことがあった．
さすがにちょっとびっくりしたが，実際そのようなことがあるため，審査の分野はよく考えたほうが良い．</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="tidyverse.html#cb133-1" aria-hidden="true" tabindex="-1"></a>domain <span class="ot">&lt;-</span> <span class="st">&quot;https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/&quot;</span></span>
<span id="cb133-2"><a href="tidyverse.html#cb133-2" aria-hidden="true" tabindex="-1"></a>dir <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;wakate/w_&quot;</span>, <span class="st">&quot;kiban_b/b_&quot;</span>, <span class="st">&quot;kiban_c/c_&quot;</span>)</span>
<span id="cb133-3"><a href="tidyverse.html#cb133-3" aria-hidden="true" tabindex="-1"></a>div <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;w_&quot;</span>, <span class="st">&quot;b_&quot;</span>, <span class="st">&quot;c_&quot;</span>)</span>
<span id="cb133-4"><a href="tidyverse.html#cb133-4" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;01010&quot;</span>,<span class="st">&quot;01020&quot;</span>,<span class="st">&quot;01030&quot;</span>,<span class="st">&quot;01040&quot;</span>,<span class="st">&quot;01050&quot;</span>,<span class="st">&quot;01060&quot;</span>,<span class="st">&quot;01070&quot;</span>,<span class="st">&quot;01080&quot;</span>)</span>
<span id="cb133-5"><a href="tidyverse.html#cb133-5" aria-hidden="true" tabindex="-1"></a>reviewers <span class="ot">&lt;-</span></span>
<span id="cb133-6"><a href="tidyverse.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(domain, dir, file) <span class="sc">%&gt;%</span></span>
<span id="cb133-7"><a href="tidyverse.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">transmute</span>(<span class="at">url =</span> <span class="fu">paste0</span>(domain, dir, file, <span class="st">&quot;.pdf&quot;</span>), </span>
<span id="cb133-8"><a href="tidyverse.html#cb133-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">destfile =</span> <span class="fu">paste0</span>(fs<span class="sc">::</span><span class="fu">path_temp</span>(), <span class="st">&quot;/&quot;</span>, div, file, <span class="st">&quot;.pdf&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb133-9"><a href="tidyverse.html#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="sc">%&gt;%</span></span>
<span id="cb133-10"><a href="tidyverse.html#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmap_chr</span>(curl<span class="sc">::</span>curl_download)</span></code></pre></div>
<pre><code>## # A tibble: 24 × 2
##    url                                                                  destfile
##    &lt;chr&gt;                                                                &lt;chr&gt;   
##  1 https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/w… C:/User…
##  2 https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/w… C:/User…
##  3 https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/w… C:/User…
##  4 https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/w… C:/User…
##  5 https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/w… C:/User…
##  6 https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/w… C:/User…
##  7 https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/w… C:/User…
##  8 https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/w… C:/User…
##  9 https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/k… C:/User…
## 10 https://www.jsps.go.jp/j-grantsinaid/01_seido/03_shinsa/meibo/r02/k… C:/User…
## # ℹ 14 more rows</code></pre>
<p>審査委員の名簿ファイル名の規則さえ分かれば，ダウンロードはRにお任せできる．
分野は実はもっと多くあるがここでは8つだけに絞っている．</p>
<p>ダウンロードしたファイル自体がたくさんあるので，まだまだ不便な状態ではある．
データとして使えるようにするには，PDFからテキストを抽出したり，その中身をデータフレーム形式の一覧にしたりという作業が必要である．
そのあたりのコードは，本書のqpdfのページや以下を参考にして欲しい．</p>
<p><a href="https://gist.github.com/matutosi/82a61628920ab476b71c46b980b97d24" class="uri">https://gist.github.com/matutosi/82a61628920ab476b71c46b980b97d24</a></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="magrittr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lubridate.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.epub", "_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3
});
});
</script>

</body>

</html>
