<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chap. 18 qpdfでPDF操作 | Rにる作業の効率化・自動化 -パッケージ活用術-</title>
  <meta name="description" content="Chap. 18 qpdfでPDF操作 | Rにる作業の効率化・自動化 -パッケージ活用術-" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chap. 18 qpdfでPDF操作 | Rにる作業の効率化・自動化 -パッケージ活用術-" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chap. 18 qpdfでPDF操作 | Rにる作業の効率化・自動化 -パッケージ活用術-" />
  
  
  

<meta name="author" content="Toshikazu Masumura" />


<meta name="date" content="2023-05-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="xlsx.html"/>
<link rel="next" href="RDCOMClient.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>はじめに</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#対象とする読者"><i class="fa fa-check"></i><b>0.1</b> 対象とする読者</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#特徴"><i class="fa fa-check"></i><b>0.2</b> 特徴</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#読み方"><i class="fa fa-check"></i><b>0.3</b> 読み方</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="R.html"><a href="R.html"><i class="fa fa-check"></i><b>1</b> Rとは</a>
<ul>
<li class="chapter" data-level="1.1" data-path="R.html"><a href="R.html#特徴-1"><i class="fa fa-check"></i><b>1.1</b> 特徴</a></li>
<li class="chapter" data-level="1.2" data-path="R.html"><a href="R.html#点突破"><i class="fa fa-check"></i><b>1.2</b> 1点突破</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>2</b> Rのインストール</a>
<ul>
<li class="chapter" data-level="2.1" data-path="install.html"><a href="install.html#ダウンロード"><i class="fa fa-check"></i><b>2.1</b> ダウンロード</a></li>
<li class="chapter" data-level="2.2" data-path="install.html"><a href="install.html#インストーラの起動"><i class="fa fa-check"></i><b>2.2</b> インストーラの起動</a></li>
<li class="chapter" data-level="2.3" data-path="install.html"><a href="install.html#インストール完了"><i class="fa fa-check"></i><b>2.3</b> インストール完了</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="package.html"><a href="package.html"><i class="fa fa-check"></i><b>3</b> パッケージのインストール</a>
<ul>
<li class="chapter" data-level="3.1" data-path="package.html"><a href="package.html#cran"><i class="fa fa-check"></i><b>3.1</b> CRANから</a></li>
<li class="chapter" data-level="3.2" data-path="package.html"><a href="package.html#アーカイブされたパッケージ"><i class="fa fa-check"></i><b>3.2</b> アーカイブされたパッケージ</a></li>
<li class="chapter" data-level="3.3" data-path="package.html"><a href="package.html#cranからpackage一覧を取得する"><i class="fa fa-check"></i><b>3.3</b> CRANからPackage一覧を取得する</a></li>
<li class="chapter" data-level="3.4" data-path="package.html"><a href="package.html#github"><i class="fa fa-check"></i><b>3.4</b> GitHubから</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="assoc.html"><a href="assoc.html"><i class="fa fa-check"></i><b>4</b> スクリプトの関連付け</a></li>
<li class="chapter" data-level="5" data-path="magrittr.html"><a href="magrittr.html"><i class="fa fa-check"></i><b>5</b> magrittrでコードを簡潔に</a>
<ul>
<li class="chapter" data-level="5.1" data-path="magrittr.html"><a href="magrittr.html#準備"><i class="fa fa-check"></i><b>5.1</b> 準備</a></li>
<li class="chapter" data-level="5.2" data-path="magrittr.html"><a href="magrittr.html#magrittrとtidyverse"><i class="fa fa-check"></i><b>5.2</b> magrittrとtidyverse</a></li>
<li class="chapter" data-level="5.3" data-path="magrittr.html"><a href="magrittr.html#でコードを簡潔に"><i class="fa fa-check"></i><b>5.3</b> <code>%&gt;%</code>でコードを簡潔に</a></li>
<li class="chapter" data-level="5.4" data-path="magrittr.html"><a href="magrittr.html#パイプの仲間"><i class="fa fa-check"></i><b>5.4</b> パイプの仲間</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="magrittr.html"><a href="magrittr.html#でオブジェクトを代入"><i class="fa fa-check"></i><b>5.4.1</b> <code>%&lt;&gt;%</code>でオブジェクトを代入</a></li>
<li class="chapter" data-level="5.4.2" data-path="magrittr.html"><a href="magrittr.html#tでコードを分岐"><i class="fa fa-check"></i><b>5.4.2</b> <code>%T&gt;%</code>でコードを分岐</a></li>
<li class="chapter" data-level="5.4.3" data-path="magrittr.html"><a href="magrittr.html#でのショートカット"><i class="fa fa-check"></i><b>5.4.3</b> <code>%$%</code>で<code>$</code>のショートカット</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="magrittr.html"><a href="magrittr.html#パイプ以外の関数"><i class="fa fa-check"></i><b>5.5</b> パイプ以外の関数</a></li>
<li class="chapter" data-level="5.6" data-path="magrittr.html"><a href="magrittr.html#おまけmagrittrの不思議な関数たち"><i class="fa fa-check"></i><b>5.6</b> おまけ：magrittrの不思議な関数たち</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stringr.html"><a href="stringr.html"><i class="fa fa-check"></i><b>6</b> stringrで文字列操作</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stringr.html"><a href="stringr.html#はじめに-1"><i class="fa fa-check"></i><b>6.1</b> はじめに</a></li>
<li class="chapter" data-level="6.2" data-path="stringr.html"><a href="stringr.html#準備-1"><i class="fa fa-check"></i><b>6.2</b> 準備</a></li>
<li class="chapter" data-level="6.3" data-path="stringr.html"><a href="stringr.html#stringrの主な関数"><i class="fa fa-check"></i><b>6.3</b> stringrの主な関数</a></li>
<li class="chapter" data-level="6.4" data-path="stringr.html"><a href="stringr.html#活用例"><i class="fa fa-check"></i><b>6.4</b> 活用例</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lubridate.html"><a href="lubridate.html"><i class="fa fa-check"></i><b>7</b> lubridateで日付・時刻を扱う</a>
<ul>
<li class="chapter" data-level="7.1" data-path="lubridate.html"><a href="lubridate.html#準備-2"><i class="fa fa-check"></i><b>7.1</b> 準備</a></li>
<li class="chapter" data-level="7.2" data-path="lubridate.html"><a href="lubridate.html#月後1年後の同一日"><i class="fa fa-check"></i><b>7.2</b> 1月後・1年後の同一日</a></li>
<li class="chapter" data-level="7.3" data-path="lubridate.html"><a href="lubridate.html#文字列からdateクラスへの変換"><i class="fa fa-check"></i><b>7.3</b> 文字列からDateクラスへの変換</a></li>
<li class="chapter" data-level="7.4" data-path="lubridate.html"><a href="lubridate.html#曜日を求める"><i class="fa fa-check"></i><b>7.4</b> 曜日を求める</a></li>
<li class="chapter" data-level="7.5" data-path="lubridate.html"><a href="lubridate.html#活用例-1"><i class="fa fa-check"></i><b>7.5</b> 活用例</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fs.html"><a href="fs.html"><i class="fa fa-check"></i><b>8</b> fsでファイル操作</a>
<ul>
<li class="chapter" data-level="8.1" data-path="fs.html"><a href="fs.html#準備-3"><i class="fa fa-check"></i><b>8.1</b> 準備</a></li>
<li class="chapter" data-level="8.2" data-path="fs.html"><a href="fs.html#shellbaseパッケージ-fsパッケージ"><i class="fa fa-check"></i><b>8.2</b> shell，baseパッケージ, fsパッケージ</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="fs.html"><a href="fs.html#shellを使う"><i class="fa fa-check"></i><b>8.2.1</b> shellを使う</a></li>
<li class="chapter" data-level="8.2.2" data-path="fs.html"><a href="fs.html#baseパッケージ"><i class="fa fa-check"></i><b>8.2.2</b> baseパッケージ</a></li>
<li class="chapter" data-level="8.2.3" data-path="fs.html"><a href="fs.html#fsパッケージ"><i class="fa fa-check"></i><b>8.2.3</b> fsパッケージ</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="fs.html"><a href="fs.html#fsの関数"><i class="fa fa-check"></i><b>8.3</b> fsの関数</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="fs.html"><a href="fs.html#パス操作"><i class="fa fa-check"></i><b>8.3.1</b> パス操作</a></li>
<li class="chapter" data-level="8.3.2" data-path="fs.html"><a href="fs.html#ディレクトリ操作"><i class="fa fa-check"></i><b>8.3.2</b> ディレクトリ操作</a></li>
<li class="chapter" data-level="8.3.3" data-path="fs.html"><a href="fs.html#ファイル操作"><i class="fa fa-check"></i><b>8.3.3</b> ファイル操作</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="fs.html"><a href="fs.html#fsを使ったファイル操作例"><i class="fa fa-check"></i><b>8.4</b> fsを使ったファイル操作例</a></li>
<li class="chapter" data-level="8.5" data-path="fs.html"><a href="fs.html#おまけguiでの作業フォルダの指定"><i class="fa fa-check"></i><b>8.5</b> おまけ：GUIでの作業フォルダの指定</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="shell.html"><a href="shell.html"><i class="fa fa-check"></i><b>9</b> system()やshell()でOSコマンドの実行</a>
<ul>
<li class="chapter" data-level="9.1" data-path="shell.html"><a href="shell.html#準備-4"><i class="fa fa-check"></i><b>9.1</b> 準備</a></li>
<li class="chapter" data-level="9.2" data-path="shell.html"><a href="shell.html#install_python"><i class="fa fa-check"></i><b>9.2</b> 活用例：Pythonとそのライブラリのインストール</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="shell.html"><a href="shell.html#pythonのイントール"><i class="fa fa-check"></i><b>9.2.1</b> Pythonのイントール</a></li>
<li class="chapter" data-level="9.2.2" data-path="shell.html"><a href="shell.html#pyautoguiのインストール"><i class="fa fa-check"></i><b>9.2.2</b> PyAutoGUIのインストール</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reticulate.html"><a href="reticulate.html"><i class="fa fa-check"></i><b>10</b> reticulateでPythonを使う</a>
<ul>
<li class="chapter" data-level="10.1" data-path="reticulate.html"><a href="reticulate.html#準備-5"><i class="fa fa-check"></i><b>10.1</b> 準備</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="reticulate.html"><a href="reticulate.html#pythonとpyautoguiのインストール"><i class="fa fa-check"></i><b>10.1.1</b> PythonとPyAutoGUIのインストール</a></li>
<li class="chapter" data-level="10.1.2" data-path="reticulate.html"><a href="reticulate.html#identify_python"><i class="fa fa-check"></i><b>10.1.2</b> 使用するPythonの指定</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="reticulate.html"><a href="reticulate.html#pythonを使ってみる"><i class="fa fa-check"></i><b>10.2</b> Pythonを使ってみる</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="reticulate.html"><a href="reticulate.html#pythonの呼び出し"><i class="fa fa-check"></i><b>10.2.1</b> Pythonの呼び出し</a></li>
<li class="chapter" data-level="10.2.2" data-path="reticulate.html"><a href="reticulate.html#rからpythonのhellow-world"><i class="fa fa-check"></i><b>10.2.2</b> RからPythonのHellow World</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="reticulate.html"><a href="reticulate.html#pythoとrとの変数のやり取り"><i class="fa fa-check"></i><b>10.3</b> PythoとRとの変数のやり取り</a></li>
<li class="chapter" data-level="10.4" data-path="reticulate.html"><a href="reticulate.html#pythonのコードを実行"><i class="fa fa-check"></i><b>10.4</b> Pythonのコードを実行</a></li>
<li class="chapter" data-level="10.5" data-path="reticulate.html"><a href="reticulate.html#rとpythoでの用語の違い"><i class="fa fa-check"></i><b>10.5</b> RとPythoでの用語の違い</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html"><i class="fa fa-check"></i><b>11</b> KeyboardSimulatorでマウス・キーボードの自動化</a>
<ul>
<li class="chapter" data-level="11.1" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#準備-6"><i class="fa fa-check"></i><b>11.1</b> 準備</a></li>
<li class="chapter" data-level="11.2" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#キーボード操作の自動化"><i class="fa fa-check"></i><b>11.2</b> キーボード操作の自動化</a></li>
<li class="chapter" data-level="11.3" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#マウスの位置取得"><i class="fa fa-check"></i><b>11.3</b> マウスの位置取得</a></li>
<li class="chapter" data-level="11.4" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#usbメモリの安全な取り出しの自動化"><i class="fa fa-check"></i><b>11.4</b> USBメモリの安全な取り出しの自動化</a></li>
<li class="chapter" data-level="11.5" data-path="keyboardsimulator.html"><a href="keyboardsimulator.html#pyautoguiで画像認識した場所にマウスポインターを動かしてクリックする"><i class="fa fa-check"></i><b>11.5</b> PyAutoGUIで画像認識した場所にマウスポインターを動かしてクリックする</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>12</b> ggplot2で楽に綺麗に作図</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ggplot2.html"><a href="ggplot2.html#準備-7"><i class="fa fa-check"></i><b>12.1</b> 準備</a></li>
<li class="chapter" data-level="12.2" data-path="ggplot2.html"><a href="ggplot2.html#rの作図環境の概要"><i class="fa fa-check"></i><b>12.2</b> Rの作図環境の概要</a></li>
<li class="chapter" data-level="12.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2とは"><i class="fa fa-check"></i><b>12.3</b> ggplot2とは</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2の利点"><i class="fa fa-check"></i><b>12.3.1</b> ggplot2の利点</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2の基本"><i class="fa fa-check"></i><b>12.4</b> ggplot2の基本</a></li>
<li class="chapter" data-level="12.5" data-path="ggplot2.html"><a href="ggplot2.html#facetで簡単に分割作図"><i class="fa fa-check"></i><b>12.5</b> facetで簡単に分割作図</a></li>
<li class="chapter" data-level="12.6" data-path="ggplot2.html"><a href="ggplot2.html#ggsave"><i class="fa fa-check"></i><b>12.6</b> ggsave</a></li>
<li class="chapter" data-level="12.7" data-path="ggplot2.html"><a href="ggplot2.html#文字化けへの対処windows"><i class="fa fa-check"></i><b>12.7</b> 文字化けへの対処(windows)</a></li>
<li class="chapter" data-level="12.8" data-path="ggplot2.html"><a href="ggplot2.html#themeを少しだけ説明"><i class="fa fa-check"></i><b>12.8</b> themeを少しだけ説明</a></li>
<li class="chapter" data-level="12.9" data-path="ggplot2.html"><a href="ggplot2.html#作図の自動化"><i class="fa fa-check"></i><b>12.9</b> 作図の自動化</a></li>
<li class="chapter" data-level="12.10" data-path="ggplot2.html"><a href="ggplot2.html#参考書"><i class="fa fa-check"></i><b>12.10</b> 参考書</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="rvest.html"><a href="rvest.html"><i class="fa fa-check"></i><b>13</b> rvestでスクレイピング</a>
<ul>
<li class="chapter" data-level="13.1" data-path="rvest.html"><a href="rvest.html#スクレイピング"><i class="fa fa-check"></i><b>13.1</b> スクレイピング</a></li>
<li class="chapter" data-level="13.2" data-path="rvest.html"><a href="rvest.html#rvest-と-rselenium"><i class="fa fa-check"></i><b>13.2</b> rvest と RSelenium</a></li>
<li class="chapter" data-level="13.3" data-path="rvest.html"><a href="rvest.html#rvestのできること"><i class="fa fa-check"></i><b>13.3</b> rvestのできること</a></li>
<li class="chapter" data-level="13.4" data-path="rvest.html"><a href="rvest.html#準備-8"><i class="fa fa-check"></i><b>13.4</b> 準備</a></li>
<li class="chapter" data-level="13.5" data-path="rvest.html"><a href="rvest.html#htmlの取得"><i class="fa fa-check"></i><b>13.5</b> HTMLの取得</a></li>
<li class="chapter" data-level="13.6" data-path="rvest.html"><a href="rvest.html#必要な情報の取得"><i class="fa fa-check"></i><b>13.6</b> 必要な情報の取得</a></li>
<li class="chapter" data-level="13.7" data-path="rvest.html"><a href="rvest.html#urlの生成データの取得"><i class="fa fa-check"></i><b>13.7</b> URLの生成・データの取得</a></li>
<li class="chapter" data-level="13.8" data-path="rvest.html"><a href="rvest.html#地図画像の取得"><i class="fa fa-check"></i><b>13.8</b> 地図画像の取得</a></li>
<li class="chapter" data-level="13.9" data-path="rvest.html"><a href="rvest.html#複数種への対応"><i class="fa fa-check"></i><b>13.9</b> 複数種への対応</a></li>
<li class="chapter" data-level="13.10" data-path="rvest.html"><a href="rvest.html#webshot"><i class="fa fa-check"></i><b>13.10</b> おまけ：webshotでウエブページを画像に変換</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rselenium.html"><a href="rselenium.html"><i class="fa fa-check"></i><b>14</b> Rseleniumでスクレイピング</a>
<ul>
<li class="chapter" data-level="14.1" data-path="rselenium.html"><a href="rselenium.html#準備-9"><i class="fa fa-check"></i><b>14.1</b> 準備</a></li>
<li class="chapter" data-level="14.2" data-path="rselenium.html"><a href="rselenium.html#ブラウザの自動化"><i class="fa fa-check"></i><b>14.2</b> ブラウザの自動化</a></li>
<li class="chapter" data-level="14.3" data-path="rselenium.html"><a href="rselenium.html#section"><i class="fa fa-check"></i><b>14.3</b> </a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="rselenium.html"><a href="rselenium.html#使い方"><i class="fa fa-check"></i><b>14.3.1</b> 使い方</a></li>
<li class="chapter" data-level="14.3.2" data-path="rselenium.html"><a href="rselenium.html#注意点"><i class="fa fa-check"></i><b>14.3.2</b> 注意点</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="rselenium.html"><a href="rselenium.html#要素の取得"><i class="fa fa-check"></i><b>14.4</b> 要素の取得</a></li>
<li class="chapter" data-level="14.5" data-path="rselenium.html"><a href="rselenium.html#その他"><i class="fa fa-check"></i><b>14.5</b> その他</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="magick.html"><a href="magick.html"><i class="fa fa-check"></i><b>15</b> magickで画像編集</a>
<ul>
<li class="chapter" data-level="15.1" data-path="magick.html"><a href="magick.html#準備-10"><i class="fa fa-check"></i><b>15.1</b> 準備</a></li>
<li class="chapter" data-level="15.2" data-path="magick.html"><a href="magick.html#使い方-1"><i class="fa fa-check"></i><b>15.2</b> 使い方</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="magick.html"><a href="magick.html#読み込み表示変換保存"><i class="fa fa-check"></i><b>15.2.1</b> 読み込み・表示・変換・保存</a></li>
<li class="chapter" data-level="15.2.2" data-path="magick.html"><a href="magick.html#切り抜き"><i class="fa fa-check"></i><b>15.2.2</b> 切り抜き</a></li>
<li class="chapter" data-level="15.2.3" data-path="magick.html"><a href="magick.html#サイズの変更"><i class="fa fa-check"></i><b>15.2.3</b> サイズの変更</a></li>
<li class="chapter" data-level="15.2.4" data-path="magick.html"><a href="magick.html#枠余白の追加註釈テキストの追加"><i class="fa fa-check"></i><b>15.2.4</b> 枠(余白)の追加・註釈(テキスト)の追加</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="magick.html"><a href="magick.html#その他の関数"><i class="fa fa-check"></i><b>15.3</b> その他の関数</a></li>
<li class="chapter" data-level="15.4" data-path="magick.html"><a href="magick.html#ウエブのスクリーンショットにurlを付加する関数"><i class="fa fa-check"></i><b>15.4</b> ウエブのスクリーンショットにURLを付加する関数</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="dbi.html"><a href="dbi.html"><i class="fa fa-check"></i><b>16</b> DBIでデータ取得</a>
<ul>
<li class="chapter" data-level="16.1" data-path="dbi.html"><a href="dbi.html#データベースとの連携"><i class="fa fa-check"></i><b>16.1</b> データベースとの連携</a></li>
<li class="chapter" data-level="16.2" data-path="dbi.html"><a href="dbi.html#dbiでできること"><i class="fa fa-check"></i><b>16.2</b> DBIでできること</a></li>
<li class="chapter" data-level="16.3" data-path="dbi.html"><a href="dbi.html#準備-11"><i class="fa fa-check"></i><b>16.3</b> 準備</a></li>
<li class="chapter" data-level="16.4" data-path="dbi.html"><a href="dbi.html#使い方-2"><i class="fa fa-check"></i><b>16.4</b> 使い方</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="xlsx.html"><a href="xlsx.html"><i class="fa fa-check"></i><b>17</b> xlsxでエクセル操作</a>
<ul>
<li class="chapter" data-level="17.1" data-path="xlsx.html"><a href="xlsx.html#準備-12"><i class="fa fa-check"></i><b>17.1</b> 準備</a></li>
<li class="chapter" data-level="17.2" data-path="xlsx.html"><a href="xlsx.html#オートフィルタの設定とウィンドウ枠の固定の自動化スクリプト"><i class="fa fa-check"></i><b>17.2</b> オートフィルタの設定とウィンドウ枠の固定の自動化スクリプト</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="xlsx.html"><a href="xlsx.html#使用方法"><i class="fa fa-check"></i><b>17.2.1</b> 使用方法</a></li>
<li class="chapter" data-level="17.2.2" data-path="xlsx.html"><a href="xlsx.html#スクリプトの内容説明"><i class="fa fa-check"></i><b>17.2.2</b> スクリプトの内容説明</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="xlsx.html"><a href="xlsx.html#その他の操作未作成"><i class="fa fa-check"></i><b>17.3</b> その他の操作(未作成)</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="qpdf.html"><a href="qpdf.html"><i class="fa fa-check"></i><b>18</b> qpdfでPDF操作</a>
<ul>
<li class="chapter" data-level="18.1" data-path="qpdf.html"><a href="qpdf.html#準備-13"><i class="fa fa-check"></i><b>18.1</b> 準備</a></li>
<li class="chapter" data-level="18.2" data-path="qpdf.html"><a href="qpdf.html#qpdfでできること"><i class="fa fa-check"></i><b>18.2</b> qpdfでできること</a></li>
<li class="chapter" data-level="18.3" data-path="qpdf.html"><a href="qpdf.html#pdfの分割"><i class="fa fa-check"></i><b>18.3</b> PDFの分割</a></li>
<li class="chapter" data-level="18.4" data-path="qpdf.html"><a href="qpdf.html#pdfの結合"><i class="fa fa-check"></i><b>18.4</b> PDFの結合</a></li>
<li class="chapter" data-level="18.5" data-path="qpdf.html"><a href="qpdf.html#pdfの圧縮最適化"><i class="fa fa-check"></i><b>18.5</b> PDFの圧縮・最適化</a></li>
<li class="chapter" data-level="18.6" data-path="qpdf.html"><a href="qpdf.html#pdfへのページ番号付加"><i class="fa fa-check"></i><b>18.6</b> PDFへのページ番号付加</a></li>
<li class="chapter" data-level="18.7" data-path="qpdf.html"><a href="qpdf.html#その他の関数-1"><i class="fa fa-check"></i><b>18.7</b> その他の関数</a></li>
<li class="chapter" data-level="18.8" data-path="qpdf.html"><a href="qpdf.html#pdftools"><i class="fa fa-check"></i><b>18.8</b> pdftoolsでテキストの取り出し</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="RDCOMClient.html"><a href="RDCOMClient.html"><i class="fa fa-check"></i><b>19</b> RDCOMClientでpdfとdocxを相互変換</a>
<ul>
<li class="chapter" data-level="19.1" data-path="RDCOMClient.html"><a href="RDCOMClient.html#準備-14"><i class="fa fa-check"></i><b>19.1</b> 準備</a></li>
<li class="chapter" data-level="19.2" data-path="RDCOMClient.html"><a href="RDCOMClient.html#rdcomclient"><i class="fa fa-check"></i><b>19.2</b> RDCOMClient</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="microsoft365r.html"><a href="microsoft365r.html"><i class="fa fa-check"></i><b>20</b> Microsoft365R</a>
<ul>
<li class="chapter" data-level="20.1" data-path="microsoft365r.html"><a href="microsoft365r.html#outlookで複数メール送信を一斉送信"><i class="fa fa-check"></i><b>20.1</b> Outlookで複数メール送信を一斉送信</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="microsoft365r.html"><a href="microsoft365r.html#インストールと初期設定"><i class="fa fa-check"></i><b>20.1.1</b> インストールと初期設定</a></li>
<li class="chapter" data-level="20.1.2" data-path="microsoft365r.html"><a href="microsoft365r.html#とりあえず使う"><i class="fa fa-check"></i><b>20.1.2</b> とりあえず使う</a></li>
<li class="chapter" data-level="20.1.3" data-path="microsoft365r.html"><a href="microsoft365r.html#メールの一斉送信"><i class="fa fa-check"></i><b>20.1.3</b> メールの一斉送信</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="microsoft365r.html"><a href="microsoft365r.html#複数のワード文書の文字列を一括置換"><i class="fa fa-check"></i><b>20.2</b> 複数のワード文書の文字列を一括置換</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="microsoft365r.html"><a href="microsoft365r.html#置換のコードの例"><i class="fa fa-check"></i><b>20.2.1</b> 置換のコードの例</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="microsoft365r.html"><a href="microsoft365r.html#年月日の更新"><i class="fa fa-check"></i><b>20.3</b> 年月日の更新</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="microsoft365r.html"><a href="microsoft365r.html#活用例-2"><i class="fa fa-check"></i><b>20.3.1</b> 活用例</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Rにる作業の効率化・自動化 -パッケージ活用術-</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="qpdf" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">Chap. 18</span> qpdfでPDF操作<a href="qpdf.html#qpdf" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="準備-13" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> 準備<a href="qpdf.html#準備-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>いつものように，まずパッケージをインストールする．
qpdfはPDF操作のためのパッケージである．
著者作パッケージのであるautomaterをインストールするが，これはCRANには登録していない．
いずれはCRANに登録したいと思っているが，現段階ではGitHubで公開している．
そのため，install.packages()ではなく，devtools::install_github()を使ってインストールする．</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="qpdf.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;qpdf&quot;</span>)</span>
<span id="cb223-2"><a href="qpdf.html#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb223-3"><a href="qpdf.html#cb223-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;matutosi/automater&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="qpdf.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb224-2"><a href="qpdf.html#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qpdf)</span>
<span id="cb224-3"><a href="qpdf.html#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(automater)</span></code></pre></div>
</div>
<div id="qpdfでできること" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> qpdfでできること<a href="qpdf.html#qpdfでできること" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>qpdfパッケージでは，PDFファイルのページ分割・抽出・結合・回転・圧縮・重ね合わせが可能である．
あくまでページ単位での操作で，PDFに含まれるテキスト自体の編集はできない．
ページ単位でのPDF操作は，Adobe AcrobatでなくてもCubePDF UtilityやPDFtkを使えば可能である．
PDFtkはコマンドラインでの操作も可能であるため，大量の操作をするには適している．
とはいえ，Rやそのパッケージで操作が自動化できればさらに便利である．</p>
<p>なお，PDF関連の他のパッケージとしてはpdftoolsがある．
pdftoolsではテキスト抽出，OCR(画像の文字認識，内部でtesseractパッケージを使用)，PDFファイルの分割・結合(内部でqpdfパッケージの関数を使用)，画像ファイルへの変換などができる．
また，Microsoft365Rを使えばPDFをワードに変換できる．
<a href="microsoft365r.html#microsoft365r">Microsoft365R</a></p>
<p>余談であるが，Rのパッケージはそれぞれ独自コードを持つ部分がある一方で，他のパッケージの関数をインポートしているものや，ラッパー関数を用意しているものなどがある．
例えば，automaterではそれ自体で有用な機能を持っているというよりは，他のパッケージを利用しやすくするためのラッパー関数の集合である．
そのため，automaterのコードをもとにさらに使いやすく改良可能であり，各自で試してほしい．</p>
</div>
<div id="pdfの分割" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> PDFの分割<a href="qpdf.html#pdfの分割" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>PDFの分割は非常に簡単である．
pdf_split()関数にinput引数として分割するファイルを，output引数として出力パスを指定すれば良い．
パスワードが必要な場合は，引数passwordを指定する．</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="qpdf.html#cb225-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wd &lt;- &quot;set_your_directory&quot;</span></span>
<span id="cb225-2"><a href="qpdf.html#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setwd(wd)</span></span>
<span id="cb225-3"><a href="qpdf.html#cb225-3" aria-hidden="true" tabindex="-1"></a>review <span class="ot">&lt;-</span> </span>
<span id="cb225-4"><a href="qpdf.html#cb225-4" aria-hidden="true" tabindex="-1"></a>  curl<span class="sc">::</span><span class="fu">curl_download</span>(</span>
<span id="cb225-5"><a href="qpdf.html#cb225-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;https://www.jstage.jst.go.jp/article/vegsci/31/2/31_193/_pdf/-char/ja&quot;</span>, </span>
<span id="cb225-6"><a href="qpdf.html#cb225-6" aria-hidden="true" tabindex="-1"></a>    fs<span class="sc">::</span><span class="fu">file_temp</span>(<span class="at">ext =</span> <span class="st">&quot;pdf&quot;</span>)</span>
<span id="cb225-7"><a href="qpdf.html#cb225-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb225-8"><a href="qpdf.html#cb225-8" aria-hidden="true" tabindex="-1"></a>split_pdf <span class="ot">&lt;-</span> qpdf<span class="sc">::</span><span class="fu">pdf_split</span>(review)</span>
<span id="cb225-9"><a href="qpdf.html#cb225-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(split_pdf)</span></code></pre></div>
<p>ファイル名の文字列のベクトルが返り値なので，それをもとにしてファイル名を変更すると実用的な自動化ができるだろう．</p>
<p>ページを指定した抽出も可能で，pdf_subset()関数を使用する．
引数としてpagesを指定する以外は，pdf_split()と同じ使い方である．</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="qpdf.html#cb226-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 指定ページを抽出，create a new pdf with a subset of the input pages</span></span>
<span id="cb226-2"><a href="qpdf.html#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf_subset</span>(input, <span class="at">pages =</span> <span class="dv">1</span>, <span class="at">output =</span> <span class="cn">NULL</span>, <span class="at">password =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>以下の内容は，パッケージautomaterのinst/rscディレクトリにあるsplit_qpdf.rscの内容である．
拡張子.rscをRscriptに関連付けすれば，split_qpdf.rscと同じフォルダに保存したPDFファイルをsplit_qpdf.rscをクリックするだけで分割できる．
拡張子の関連付けは，<a href="assoc.html#assoc">スクリプトの関連付け</a>を参照して欲しい．</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="qpdf.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>(<span class="st">&quot;rsc/split_qpdf.rsc&quot;</span>, <span class="at">package =</span> <span class="st">&quot;automater&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb227-2"><a href="qpdf.html#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readLines</span>() <span class="sc">%&gt;%</span></span>
<span id="cb227-3"><a href="qpdf.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="at">collapse =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb227-4"><a href="qpdf.html#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code></pre></div>
<pre><code>##   #  #  #  #  #  #  #  #  #  #  #  #  #  #  #  #  #  #  # 
##   # 
##   # See https://github.com/matutosi/automater/blob/main/vignettes/split_qpdf.md
##   # 
##   #  #  #  #  #  #  #  #  #  #  #  #  #  #  #  #  #  #  # 
## 
##   # Prepare
## pkg &lt;- &quot;devtools&quot;
## if(! pkg %in% installed.packages()[,1]){
##   install.packages(pkg, repo = &quot;https://cran.ism.ac.jp/&quot;)
## }
## 
## pkg &lt;- &quot;automater&quot;
## ver &lt;- utils::packageDescription(pkg, fields = &quot;Version&quot;)
## if(utils::compareVersion(ver, &quot;0.2.0&quot;) &lt; 0){
##   devtools::install_github(&quot;matutosi/automater&quot;, upgrade = &quot;never&quot;, force = TRUE)
## }
## 
## automater::validate_package(&quot;qpdf&quot;)
## automater::validate_package(&quot;stringr&quot;)
## 
##   # Run
## files &lt;- list.files(pattern = &quot;\\.pdf&quot;)
## for(file in files){
##   output &lt;- qpdf::pdf_split(file)
##   n_page &lt;- qpdf::pdf_length(file)
##   extra &lt;- 0  # to avoid dupulicated file name, add extra degits
##   numbered &lt;- automater::file_numbered(file, n_page, extra = extra)
##   while(automater::is_duplicated(files, numbered)){
##     extra &lt;- extra + 1
##     numbered &lt;- automater::file_numbered(file, n_page, extra = extra)
##   }
##   file.rename(output, numbered)
## }
## 
## automater::message_to_continue()</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="qpdf.html#cb229-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># system.file(&quot;rsc/split_qpdf.rsc&quot;, package = &quot;automater&quot;) %&gt;%</span></span>
<span id="cb229-2"><a href="qpdf.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   readtext::readtext(verbosity = 0) %&gt;%</span></span>
<span id="cb229-3"><a href="qpdf.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   `[[`(&quot;text&quot;) %&gt;%</span></span>
<span id="cb229-4"><a href="qpdf.html#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   cat()</span></span></code></pre></div>
<p>具体的な方法は次のとおりである．
- split_qpdf.rsc をディレクトリーに保存する
- 以下のコードで split_qpdf.rsc をコピー可能</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="qpdf.html#cb230-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;split_qpdf&quot;</span></span>
<span id="cb230-2"><a href="qpdf.html#cb230-2" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;c:/&quot;</span> <span class="co"># set your path</span></span>
<span id="cb230-3"><a href="qpdf.html#cb230-3" aria-hidden="true" tabindex="-1"></a>automater<span class="sc">::</span><span class="fu">set_rsc</span>(file, path)</span></code></pre></div>
<ul>
<li>拡張子 .rsc を Rscript.exe に関連付ける</li>
<li>分割したいPDFファイルを split_qpdf.rsc と同じディレクトリにコピーする</li>
<li>split_qpdf.rsc をクリックする</li>
<li>黒いウィンドウが開くので，しばらく待つ</li>
</ul>
<p>split_qpdf.rsc を初めて実行するときは，パッケージのインストールに時間がかかることがある．
出力ファイル名は以下のとおりである．
- 入力：「original.pdf」(15ページ)
- 出力: “original_01.pdf”, “original_02.pdf”, …, “original_15.pdf”</p>
</div>
<div id="pdfの結合" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> PDFの結合<a href="qpdf.html#pdfの結合" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>結合させる場合は，input引数に結合させたいファイル名を指定する．
それ以外は，pdf_split()と同様である．</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="qpdf.html#cb231-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 結合，join several pdf files into one</span></span>
<span id="cb231-2"><a href="qpdf.html#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf_combine</span>(input, <span class="at">output =</span> <span class="cn">NULL</span>, <span class="at">password =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>特定のディレクトリ内のPDFファイルを1つのPDFファイルとして結合することを自動化するスクリプトは以下のとおりである．</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="qpdf.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>(<span class="st">&quot;rsc/combine_qpdf.rsc&quot;</span>, <span class="at">package =</span> <span class="st">&quot;automater&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;D:/pf/R/R-4.3.0/library/automater/rsc/combine_qpdf.rsc&quot;</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="qpdf.html#cb234-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readLines</span>() <span class="sc">%&gt;%</span></span>
<span id="cb234-2"><a href="qpdf.html#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="at">collapse =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb234-3"><a href="qpdf.html#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code></pre></div>
<ul>
<li>combine_qpdf.rsc をディレクトリに保存
<ul>
<li>以下のコードで、combine_qpdf.rsc をコピー可能</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="qpdf.html#cb235-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;combine_qpdf&quot;</span></span>
<span id="cb235-2"><a href="qpdf.html#cb235-2" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;c:/&quot;</span> <span class="co"># set your path</span></span>
<span id="cb235-3"><a href="qpdf.html#cb235-3" aria-hidden="true" tabindex="-1"></a>automater<span class="sc">::</span><span class="fu">set_rsc</span>(file, path)</span></code></pre></div>
<ul>
<li>拡張子 .rsc を Rscript.exe に関連付ける<br />
</li>
<li>結合したいPDFファイルを combine_qpdf.rsc と同じディレクトリにコピーする<br />
ファイルの結合順はファイル名の順序と同じ</li>
<li>combine_qpdf.rsc をクリックする<br />
</li>
<li>黒いウィンドウが開くので，しばらく待つ<br />
初めて実行するときは，パッケージのインストールに時間がかかることがある．<br />
</li>
<li>結合したファイル名は以下のとおりである．<br />
出力: 「combined_“2020-11-27_12_00_00.pdf”」(結合した日付・時刻)</li>
</ul>
<p>PDFファイルの結合順はファイル名の順序と同じなので，<code>fs::dir_ls()</code>でファイル名一覧を取得し，<code>file_move()</code>で名前を変更する必要がある．
さらに，このあたりも自動化するには，ユーザからの入力を受け取り，それをもとにファイル名の順序を決めれば良い．</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="qpdf.html#cb236-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wd &lt;- &quot;set_your_directory&quot;</span></span>
<span id="cb236-2"><a href="qpdf.html#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setwd(wd)</span></span>
<span id="cb236-3"><a href="qpdf.html#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb236-4"><a href="qpdf.html#cb236-4" aria-hidden="true" tabindex="-1"></a>input_files <span class="ot">&lt;-</span> <span class="cf">function</span>(files){</span>
<span id="cb236-5"><a href="qpdf.html#cb236-5" aria-hidden="true" tabindex="-1"></a>  len <span class="ot">&lt;-</span> <span class="fu">length</span>(files) <span class="sc">%&gt;%</span> <span class="fu">log10</span>() <span class="sc">%&gt;%</span> <span class="fu">ceiling</span>()</span>
<span id="cb236-6"><a href="qpdf.html#cb236-6" aria-hidden="true" tabindex="-1"></a>  no <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_pad</span>(<span class="fu">seq</span>(files), <span class="at">width =</span> len, <span class="at">side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb236-7"><a href="qpdf.html#cb236-7" aria-hidden="true" tabindex="-1"></a>  prompt <span class="ot">&lt;-</span> </span>
<span id="cb236-8"><a href="qpdf.html#cb236-8" aria-hidden="true" tabindex="-1"></a>    files <span class="sc">%&gt;%</span></span>
<span id="cb236-9"><a href="qpdf.html#cb236-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(no, <span class="st">&quot;: &quot;</span>, .) <span class="sc">%&gt;%</span></span>
<span id="cb236-10"><a href="qpdf.html#cb236-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="at">collapse =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb236-11"><a href="qpdf.html#cb236-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">結合するファイルを番号で指定してください(カンマ区切り)．</span><span class="sc">\n</span><span class="st">  例：3,1,2</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb236-12"><a href="qpdf.html#cb236-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>()</span>
<span id="cb236-13"><a href="qpdf.html#cb236-13" aria-hidden="true" tabindex="-1"></a>  input_order <span class="ot">&lt;-</span> </span>
<span id="cb236-14"><a href="qpdf.html#cb236-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">user_input</span>(prompt) <span class="sc">%&gt;%</span></span>
<span id="cb236-15"><a href="qpdf.html#cb236-15" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_split</span>(<span class="st">&quot;,&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb236-16"><a href="qpdf.html#cb236-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb236-17"><a href="qpdf.html#cb236-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb236-18"><a href="qpdf.html#cb236-18" aria-hidden="true" tabindex="-1"></a>  files[input_order]</span>
<span id="cb236-19"><a href="qpdf.html#cb236-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb236-20"><a href="qpdf.html#cb236-20" aria-hidden="true" tabindex="-1"></a>user_input <span class="ot">&lt;-</span> <span class="cf">function</span>(prompt){</span>
<span id="cb236-21"><a href="qpdf.html#cb236-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">interactive</span>()) {</span>
<span id="cb236-22"><a href="qpdf.html#cb236-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">readline</span>(prompt))</span>
<span id="cb236-23"><a href="qpdf.html#cb236-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb236-24"><a href="qpdf.html#cb236-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(prompt)</span>
<span id="cb236-25"><a href="qpdf.html#cb236-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">readLines</span>(<span class="st">&quot;stdin&quot;</span>, <span class="at">n=</span><span class="dv">1</span>))</span>
<span id="cb236-26"><a href="qpdf.html#cb236-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb236-27"><a href="qpdf.html#cb236-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb236-28"><a href="qpdf.html#cb236-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-29"><a href="qpdf.html#cb236-29" aria-hidden="true" tabindex="-1"></a>files <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="at">regexp =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.pdf&quot;</span>)</span>
<span id="cb236-30"><a href="qpdf.html#cb236-30" aria-hidden="true" tabindex="-1"></a>input <span class="ot">&lt;-</span> <span class="fu">input_files</span>(files)</span>
<span id="cb236-31"><a href="qpdf.html#cb236-31" aria-hidden="true" tabindex="-1"></a>input</span>
<span id="cb236-32"><a href="qpdf.html#cb236-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-33"><a href="qpdf.html#cb236-33" aria-hidden="true" tabindex="-1"></a>automater<span class="sc">::</span><span class="fu">message_to_continue</span>()</span></code></pre></div>
<p>上のコードの<code>input_files()</code>では，ファイル名の一覧からファイル数を取り出し，ファイル番号を画面表示用に桁揃えしている．
その後，ファイル番号とファイル名，さらにユーザへの註釈を結合して，プロンプトに表示するメッセージ文字列を生成する．
メッセージを<code>user_input()</code>を用いて表示するとともに，ユーザからの入力を受け取る．
入力された文字列を数値にして，ファイルの順序を決めている．</p>
<p>このコードの<code>input</code>を<code>pdf_combine(input)</code>として使えば，ユーザ入力をもとにしてPDFファイルを結合するスクリプトができる．
入力する番号が数個であれば，これでも良いがもっと多くのファイルになった場合は現実的には使いにくい．
多くのファイルを結合する場合は，以下のような方法で実装すると良いだろう．</p>
<ul>
<li><code>fs::dir_ls(regexp = "\\.pdf")</code>でファイル名の一覧を入手<br />
</li>
<li>一覧をもとに1行ごとに1つのファイル名のテキストファイルとして保存<br />
</li>
<li>テキストファイルをユーザが並び替える(Rでは並び替えが終わるまで待機)<br />
</li>
<li>並び替えが終われば，RでEnter(他のキーでもOK)を入力<br />
</li>
<li>テキストファイルを読み込み，や<code>combine_qpdf()</code>(<code>pdf_combine()</code>でもOK)でPDFを結合</li>
</ul>
</div>
<div id="pdfの圧縮最適化" class="section level2 hasAnchor" number="18.5">
<h2><span class="header-section-number">18.5</span> PDFの圧縮・最適化<a href="qpdf.html#pdfの圧縮最適化" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>pdf_compress()は圧縮や最適化(Linealize)をしてくれる．
最適化されていないPDFはファイルを全部読み込まないと表示できないのに対して，
最適化されたPDFは最後まで読み込みが完了しなくてもページ表示できる．
ネット上にある重いPDFを表示させる場合に特に役立つ．
使い方は次のとおりである．
詳細な説明は不要だろう．</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="qpdf.html#cb237-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 圧縮，compress or linearize a pdf file</span></span>
<span id="cb237-2"><a href="qpdf.html#cb237-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 最適化する場合は，linearize = TRUE</span></span>
<span id="cb237-3"><a href="qpdf.html#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf_compress</span>(input, <span class="at">output =</span> <span class="cn">NULL</span>, <span class="at">linearize =</span> <span class="cn">FALSE</span>, <span class="at">password =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
</div>
<div id="pdfへのページ番号付加" class="section level2 hasAnchor" number="18.6">
<h2><span class="header-section-number">18.6</span> PDFへのページ番号付加<a href="qpdf.html#pdfへのページ番号付加" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>pdf_overlay_stamp()</code>を使うと，PDFファイルに別のPDFファイルを重ね合わせることができる．</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="qpdf.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf_overlay_stamp</span>(input, stamp, <span class="at">output =</span> <span class="cn">NULL</span>, <span class="at">password =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>引数<code>input</code>にはベースとなるPDFファイルを，<code>stamp</code>には重ね合わせるPDFファイルを指定する．
<code>stamp</code>として「部外秘」「資料1」などを記載したPDFファイルをあらかじめ準備しておく．
<code>input</code>の各ページに<code>stamp</code>の1ページ目が重ね合わせられる．</p>
<p>これだけでも十分便利な機能であるが，さらに便利に使いたい．
例えば，ベースのPDFファイルの各ページにページ番号を入力したい．
ページ番号でなくて別の通し番号を使いたいときもあるだろう．
例えば，学会の発表要旨集で左上に「A01」「A02」のような会場番号と通し番号を使うことが多い．
さらに欲をだして，重ね合わせの開始・終了ページを指定するようにしたい．</p>
<p>これらの内容を実行するコードは次のとおりである．</p>
<pre><code>#&#39; Wrapper functions to overlay page numbers and others using package qpdf.
#&#39; 
#&#39; pdf_overlay_stamps_each() overlay PDF for each page in pdf file. 
#&#39; validate_page() is a helper function for pdf_overlay_stamps_each() 
#&#39; to validate page consistency of among page no. of input, stamp, start and end.
#&#39; pdf_overlay_page_num() and pdf_overlay_session_num() are wrapper functions to 
#&#39; overlay page no. and session no. for accademic congress or symposium etc. 
#&#39; pdf_overlay_page_num() can overlay up to 100 pages.
#&#39; 
#&#39; Package qpdf &lt;https://cran.r-project.org/web/packages/qpdf/index.html&gt;
#&#39; includes useful functions as shown bellow.
#&#39; pdf_length(), pdf_split(), pdf_subset(), pdf_combine(), 
#&#39; pdf_compress(), pdf_rotate_pages(), pdf_overlay_stamp().
#&#39; 
#&#39; @name pdf_overlay
#&#39; @param input,stamp  A string of file name or path of pdf file.
#&#39;                     input is a base pdf and stamp will be overlayed.
#&#39;                     No. of pages in stamp PDF should be equal to or over no. of pages in input PDF.
#&#39;                     Pages in stamp exceeding pages over input pages will be ignored.
#&#39; @param start,end    An integer of start and end page to be stamped.
#&#39;                     negative integer can be used for end, which means
#&#39;                     number from the last page.
#&#39; @param len_input,len_stamp    An integer to validate.
#&#39; @param session      A string of session name. Can use &quot;a&quot;, &quot;b&quot;, or &quot;p&quot;.
#&#39;                     &#39;session = &quot;a&quot;&#39; uses &#39;pdf/00_sn_a.pdf&#39; as stamp. 
#&#39;                     pdf directory include &#39;00_sn_a.pdf&#39;, &#39;00_sn_b.pdf&#39;, and &#39;00_sn_p.pdf&#39; 
#&#39;                     by default, which invlude 50 pages (eg., A01, A02, ..., A50) respectively.
#&#39; @examples
#&#39; \dontrun{
#&#39; input &lt;- system.file(&quot;pdf/00_sn_a.pdf&quot;, package = &quot;automater&quot;)
#&#39; pdf_overlay_page_num(input, start = 11, end = -3)
#&#39; pdf_overlay_session_num(input, session = &quot;b&quot;)
#&#39; }
#&#39; 
#&#39; @return  A string of output pdf file.
#&#39; @export
pdf_overlay_stamps_each &lt;- function(input, stamp, start = 1, end = NULL){
  len_input &lt;- qpdf::pdf_length(input)
  len_stamp &lt;- qpdf::pdf_length(stamp)
  if(is.null(end)){ end &lt;- len_input }
  if(end &lt; 0     ){ end &lt;- len_input + end}
  validate_page(len_input, len_stamp, start, end)
  pages_inputs &lt;- seq(to = len_input)
    # +1 means out of bounds, inputs[pages_pre]: NA
  pages_pre    &lt;- if(start != 1      ){ seq(to = start - 1)                 } else { len_input + 1 }
  pages_post   &lt;- if(end != len_input){ seq(from = end  + 1, to = len_input)} else { len_input + 1 }
  pages_body   &lt;- pages_inputs[-c(pages_pre, pages_post)]
  inputs &lt;- qpdf::pdf_split(input)
  stamps &lt;- qpdf::pdf_split(stamp)
  out &lt;- list()
  for(i in seq_along(pages_body)){
    out[[i]] &lt;- qpdf::pdf_overlay_stamp(inputs[pages_body[i]], stamps[i])
  }
  out &lt;- stats::na.omit(c(inputs[pages_pre], unlist(out), inputs[pages_post]))
  outfile &lt;- qpdf::pdf_combine(out, &quot;out.pdf&quot;)
  file.remove(inputs)
  file.remove(stamps)
  file.remove(out[pages_body])
  return(outfile)
}

#&#39; @rdname pdf_overlay
#&#39; @export
validate_page &lt;- function(len_input, len_stamp, start, end){
  if(end       &lt; start)    { stop(&quot;end must be larger than start!&quot;) }
  if(len_input &lt; start)    { stop(&quot;input pages must be larger than start!&quot;) }
  if(len_input &lt; end  )    { stop(&quot;input pages must be larger than end!&quot;) }
  if(len_input &gt; len_stamp){ stop(&quot;stamp pages must be equal to or bigger than input!&quot;) }
}

#&#39; @rdname pdf_overlay
#&#39; @export
pdf_overlay_page_num &lt;- function(input, start = 1, end = NULL){
  stamp &lt;- file.path(find.package(&quot;automater&quot;), &quot;pdf/00_page.pdf&quot;)
  pdf_overlay_stamps_each(input, stamp, start, end)
}

#&#39; @rdname pdf_overlay
#&#39; @export
pdf_overlay_session_num &lt;- function(input, start = 1, end = NULL, session = &quot;a&quot;){
  stamp &lt;- file.path(find.package(&quot;automater&quot;), &quot;pdf/00_sn_&quot;, session, &quot;.pdf&quot;)
  pdf_overlay_stamps_each(input, stamp, start, end)
}</code></pre>
<p><code>pdf_overlay_stamps_each()</code>の引数には，<code>input</code>，<code>stamp</code>，<code>start</code>，<code>end</code>がある．
<code>input</code>と<code>stamp</code>はqpdfの他の関数と同様の引数で，ファイルのパスを文字列で指定する．
<code>start</code>と<code>end</code>は，<code>input</code>での重ね合わせ対象とするページ数の開始・終了ページで，整数で指定する．
最後からのページ数とするには，<code>end</code>を負の数で指定する．</p>
<p>関数の主な構成は以下のとおりである．
- input<code>と</code>stamp<code>のページ数を取得    -</code>start<code>や</code>end<code>との整合性を</code>validate_page()<code>で確認    - 重ね合わせ対象よりも前(</code>pages_pre<code>)，後ろ(</code>pages_post<code>)，重ね合わせの対象のページ(</code>pages_body<code>)を取得   -</code>pdf_split()<code>で</code>input<code>と</code>stamp<code>を1ページごとに分割    -</code>pages_body<code>の部分のみ，</code>stamp<code>の各ページを重ね合わせ    - combine_pdf()で使うためのファイル名を結合(</code>pages_pre<code>，</code>pages_body<code>，</code>pages_post`)<br />
- combine_pdf()でファイルの結合<br />
- 使用後のファイルを削除<br />
- 結合したファイル名を返す</p>
<p>なお，ページ番号と学会でのセッション番号を付与するためのラッパー関数として，それぞれ<code>pdf_overlay_page_num()</code>と<code>pdf_overlay_session_num()</code>がある．
<code>pdf_overlay_page_num()</code>は，<code>input</code>のPDFだけ指定すれば全ページに番号を付加し，<code>start</code>と<code>end</code>が指定可能である．
ただし，最大ページ数は100ページである．
<code>pdf_overlay_session_num()</code>は，さらに<code>session</code>を指定して「A01」のような番号を左上に付加する．</p>
<p>pdf_overlay_page_num(input, start = 1, end = NULL)
pdf_overlay_session_num(input, start = 1, end = NULL, session = “a”)</p>
<p>パッケージautomaterのpdfフォルダには，ページ番号と学会でのセッション番号を付加するためのPDFファイル(すべてA4版)がある．
- 00_page.pdf
- 00_sn_a.pdf，00_sn_b.pdf，00_sn_p.pdf
ページ番号は，下部に「-1-」などの表記があり100ページ分からなる．
セッション番号は，左上に「A01」(A会場を想定)「B01」「P01」(ポスター会場を想定)などの表記があり，50番までが入っている．
それぞれのtexソースファイルも保存されている．
texを使うのが難しければ，ワードなどで同様の書式のファイルを作成したものをPDFとして保存すれば良い．</p>
</div>
<div id="その他の関数-1" class="section level2 hasAnchor" number="18.7">
<h2><span class="header-section-number">18.7</span> その他の関数<a href="qpdf.html#その他の関数-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>これまでで説明した以外に，qpdfには<code>pdf_length()</code>と<code>pdf_rotate_pages()</code>がある．
<code>pdf_length()</code>は入力したPDFファイルのページ数を返す．
<code>pdf_rotate_pages()</code>はPDFファイルのページを90度単位で回転できる．
<code>angle</code>で時計回りの角度を指定する．
<code>relative</code>が<code>TRUE</code>のときは入力時点での角度からの相対的な角度で回転し，<code>FALSE</code>のときは<code>angle = 0</code>のときは縦長で<code>angle = 90</code>のときは横長になる．</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="qpdf.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf_length</span>(input, <span class="at">password =</span> <span class="st">&quot;&quot;</span>)   </span>
<span id="cb240-2"><a href="qpdf.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf_rotate_pages</span>(input, pages, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">relative =</span> <span class="cn">FALSE</span>, <span class="at">output =</span> <span class="cn">NULL</span>, <span class="at">password =</span> <span class="st">&quot;&quot;</span>)   </span></code></pre></div>
</div>
<div id="pdftools" class="section level2 hasAnchor" number="18.8">
<h2><span class="header-section-number">18.8</span> pdftoolsでテキストの取り出し<a href="qpdf.html#pdftools" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>pdftoolsパッケージでは，テキスト抽出，OCR(画像の文字認識)，PDFファイルの分割・結合，画像ファイルへの変換などができる．
このうち，OCRではtesseractパッケージを，PDFの分割・結合ではqpdfパッケージの関数を使っており，直接それぞれのパッケージを使うのと基本的には同じ，画像ファイルへの変換はmagickパッケージで可能である．
そのため，ここでは他のパッケージでは実装していないテキスト抽出を説明する．
なお，テキスト抽出にはpopplerを使っている．
Windows版のpdftoolsパッケージではpopplerが含まれているのでパッケージのインストールだけで使用可能である．
MacやLinuxでは，popplerを別途インストールしなければならない．
popplerのインストール方法は以下を参考にして欲しい．</p>
<p><a href="https://docs.ropensci.org/pdftools/" class="uri">https://docs.ropensci.org/pdftools/</a></p>
<p>まずは，パッケージのインストールと呼び出しを実行する．</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="qpdf.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;pdftools&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="qpdf.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pdftools)</span></code></pre></div>
<p>関数<code>pdf_text()</code>にPDFファイルのパスを指定すれば，テキストを抽出した結果が得られる．
1ページごとの内容が文字列のベクトルになっている．</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="qpdf.html#cb243-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># https://docs.ropensci.org/pdftools/</span></span>
<span id="cb243-2"><a href="qpdf.html#cb243-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;http://arxiv.org/pdf/1403.2805.pdf&quot;</span></span>
<span id="cb243-3"><a href="qpdf.html#cb243-3" aria-hidden="true" tabindex="-1"></a>destfile <span class="ot">&lt;-</span> <span class="st">&quot;1403.2805.pdf&quot;</span></span>
<span id="cb243-4"><a href="qpdf.html#cb243-4" aria-hidden="true" tabindex="-1"></a>curl<span class="sc">::</span><span class="fu">curl_download</span>(url, destfile)</span>
<span id="cb243-5"><a href="qpdf.html#cb243-5" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> pdftools<span class="sc">::</span><span class="fu">pdf_text</span>(destfile)</span>
<span id="cb243-6"><a href="qpdf.html#cb243-6" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">as_tibble</span>(txt)</span></code></pre></div>
<pre><code>## # A tibble: 29 × 1
##    value                                                                        
##    &lt;chr&gt;                                                                        
##  1 &quot;                                              The jsonlite Package: A Pract…
##  2 &quot;JSON with R. We refer to Nolan and Temple Lang (2014) for a comprehensive i…
##  3 &quot;homogenous. And indeed, some implementations will now return a list instead…
##  4 &quot;The alternative to class-based method dispatch is to use type-based encodin…
##  5 &quot;2       Converting between JSON and R classes\n\nThis section lists example…
##  6 &quot;encoding. However, the problem with encoding missing values as strings is t…
##  7 &quot;limitations as text based formats such as CSV.\n\n\n2.1.3      Special case…
##  8 &quot;is assuming an array, the application will likely break. Any consumer or cl…
##  9 &quot;We expect this representation will be the most intuitive to interpret, also…
## 10 &quot;colnames(x) &lt;- c(\&quot;Treatment A\&quot;, \&quot;Treatment B\&quot;)\nprint(x)\n\n        Tre…
## # ℹ 19 more rows</code></pre>
<p>文字列内の<code>\n</code>は改行を示しているが，そのままでは読みにくい．
<code>\n</code>で改行して画面で表示するには<code>cat()</code>を使う．</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="qpdf.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(txt[<span class="dv">1</span>])  <span class="co"># [1]で1ページ目</span></span></code></pre></div>
<!--
  # install.packages("Rpoppler")
  # library(Rpoppler)
  # ?Rpoppler::PDF_text()
-->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="xlsx.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="RDCOMClient.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.epub", "_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3
});
});
</script>

</body>

</html>
