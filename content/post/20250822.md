---
title: "消える画像のスクリーンショット"
date: 2025-08-22
draft: false
tags: [etc]
categories: [blog,r]
---

Windowsで[PrtSc]キーを押したときに出てくる「四角形」とか「ウィンドウ」とかを選ぶウィンドウの画像を使いたいと思った．
この画面を撮影しようとすると，消えてしまってうまくいかない．

[20250822_screenshot_icon.png]

そこで，screenshotパッケージで使っている screenshot.exe とcmdでのスリープを活用して撮影することにした．

- https://matutosi.github.io/screenshot/   


```
REM screenshot.bat
REM   Windowsでスクリーンショット画像を撮影するときに出てくる画像のスクリーンショットを撮影する方法
REM   普通なら，スクリーンショットを撮影するときに消えてしまうので，うまくいかない
REM   cmd timeout でスリープさせている間に，スクリーンショットの画像を出して
REM   screenshot パッケージの実行ファイル(screenshot.exe)でスクリーンショットをとる
timeout 10 REM 10秒スリープ：時間が短いときは適宜増やす
screenshot.exe screenshot_icon.png
```

- screenshot.exe のファイルのあるディレクトリに上のコードを screenshot.bat という名前で保存する   
- screenshot.bat の起動する   
- [PrtSc]を押してスクリーンショットを撮影したい画面にする   
- しばし待機する   
- screenshot_icon.png という画像が保存される   

